!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Od){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Od),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Te=u=u||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,C="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},_=C||self;function k(){}function R(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var S="closure_uid_"+(1e9*Math.random()>>>0),L=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:V).apply(null,arguments)}function j(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function x(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,S)&&t[S]||(t[S]=++L))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var K=_.navigator;if(K){K=K.userAgent;if(K){W=K;break t}}W=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=k;var nt,rt=X(W,"Opera"),it=X(W,"Trident")||X(W,"MSIE"),ot=X(W,"Edge"),st=ot||it,ut=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),at=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ht(){var t=_.document;return t?t.documentMode:void 0}t:{var ct="",lt=(lt=W,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ct=lt?lt[1]:""),it){lt=ht();if(null!=lt&&lt>parseFloat(ct)){nt=String(lt);break t}}nt=ct}var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=Y(String(nt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=_.document&&it?ht()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",k,e),_.removeEventListener("test",k,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},x(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function It(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new It(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var _t="closure_lm_"+(1e6*Math.random()|0),kt={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[Et]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Dt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,D(r)?!!r.capture:!!r,i):Dt(t,e,n,!1,r,i)}function Dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Ut(t);if(h||(t[_t]=h=new At(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function St(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Ct(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Ct(n,t),0==n.b&&(n.src=null,e[_t]=null)):Nt(t)))}function Lt(t){return t in kt?kt[t]:kt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&St(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function Ut(t){return(t=t[_t])instanceof At?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function xt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ct(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(xt,q),xt.prototype[Et]=!0,(A=xt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&St(r))}(this,t,e,n,r)},A.G=function(){if(xt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=_.JSON.stringify;function zt(){this.b=this.a=null}var Bt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Yt},function(t){t.reset()}));function Wt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Xt(t,e){var n;Bt||(n=_.Promise.resolve(void 0),Bt=function(){n.then(Jt)}),Qt||(Bt(),Qt=!0),Kt.add(t,e)}zt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new zt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){_.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function $t(t,e){xt.call(this),this.b=t||1,this.a=e||_,this.f=U(this.Za,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}x($t,xt),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(I(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(_.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}x(ue,q);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&St(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new xt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}pe.Fa="serverreachability",x(ve,mt),pe.STAT_EVENT="statevent",x(me,mt),pe.Ga="timingevent",x(be,mt);var Te={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ie={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ne(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ce(){}Ne.prototype.a=null;var Oe,C={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function _e(){mt.call(this,"d")}function ke(){mt.call(this,"c")}function Re(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Se,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}x(_e,mt),x(ke,mt),x(Re,Ne),Oe=new Re;var Se=45e3,Le={},Pe={};function Ve(t,e,n){t.H=1,t.i=nn(Ke(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=M(),Me(t),t.l=Ke(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=hr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(U(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?Le:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,we(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Le){t.h=4,we(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),Fe(t))}function Me(t){t.T=M()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(U(t.Va,t),e)}function qe(t){t.o&&(_.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Ge(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Wn(u)}tr(u),we(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(U(u.Sa,u),6e3));if(Tn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Nn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Qn(u)):"stop"!=h[0]&&"close"!=h[0]||sr(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?sr(u,7):Hn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ge(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=De.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Ge(this),Fe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(je(this,e,n),st&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Wa),this.R.start())):(fe(this.c,this.f,n,null),ze(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Ge(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),je(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Ge(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Ge(this),this.h=2,Fe(this)):xe(this,this.T-n)},(A=He.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Xe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ke(t){return new Qe(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),Ye(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),B(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ia&&_.ia.ya&&_.ia.ya()&&_.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Cn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function _n(){this.a=new On}function kn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Cn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Rn=_.JSON.parse;function Dn(t){xt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}x(Dn,xt);var Sn="",Ln=/^https?$/i,Pn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),xn(t)}function jn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Mn(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Xe)[1]||null)&&_.self&&_.self.location&&(i=(r=_.self.location.protocol).substr(0,r.length-1)),n=!Ln.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",jn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zn("baseRetryDelayMs",5e3,t),this.Ra=zn("retryDelaySeedMs",1e4,t),this.Ma=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new _n,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,en(n=Ke(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=nn(Ke(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.i.toString(),"")),!n&&_.Image&&((new Image).src=e.i,n=!0),n||(e.a=hr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Wn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Yn(t){Wn(t),t.j&&(_.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&_.clearTimeout(t.h),t.h=null)}function Xn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Qn(t)}function Qn(t){En(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Nn(t.b,n),Ve(n,r,e)}function Jn(t,n){t.f&&Be({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Be(t,function(t,e){var n=t;D(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Xt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(U(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new De(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ke(e)),n.j=null,n.I=!0,Ue(n,t)}function rr(t){null!=t.m&&(_.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,qt(i=ye(),new be(i)),Qn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ee(U(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Ya,t),r||(r=new Qe("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,_.Image?((i=new Image).onload=j(kn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=j(kn,o,i,"TestLoadImage: error",!1,r),i.onabort=j(kn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=j(kn,o,i,"TestLoadImage: timeout",!1,r),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Yn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Cn(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Qe?Ke(s):new Qe(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=_.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Qe(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function hr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Na)).F=t.C,e}function cr(){}function lr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function fr(t,e){xt.call(this),this.a=new Bn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){ke.call(this),this.status=1}function yr(t){this.a=t}(A=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Oe),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new He(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=_.FormData&&t instanceof _.FormData,0<=F(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},A.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),xn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),Dn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},A.Ua=function(){Mn(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Ke(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Gn(i,this.i,r),Nn(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||En(this.b)||Kn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(U(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Wn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Wn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=cr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},lr.prototype.a=function(t,e){return new fr(t,e)},x(fr,xt),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Qn(t)},fr.prototype.close=function(){Hn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Xn(this.a,e)):this.l?((e={}).__data__=Gt(t),Xn(this.a,e)):Xn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,fr.X.G.call(this)},x(pr,_e),x(dr,ke),x(yr,cr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ce.EventType=C).OPEN="a",C.CLOSE="b",C.ERROR="c",C.MESSAGE="d",xt.prototype.listen=xt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.W,Dn.prototype.getResponseJson=Dn.prototype.Pa,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var vr=ye,gr=Te,mr=Ie,wr=pe,br=10,Er=11,Tr=Ce,Ir=Dn,Nr=(Ar.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ar.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ar.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ar);function Ar(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Cr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Or=(Object.defineProperty(Rr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Rr.prototype.isEqual=function(t){return t instanceof Rr&&t.projectId===this.projectId&&t.database===this.database},Rr),_r=(kr.prototype.u=function(){return null!=this.uid},kr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},kr.prototype.isEqual=function(t){return t.uid===this.uid},kr);function kr(t){this.uid=t}function Rr(t,e){this.projectId=t,this.database=e||"(default)"}_r.UNAUTHENTICATED=new _r(null),_r.l=new _r("google-credentials-uid"),_r._=new _r("first-party-uid");var Dr=new l("@firebase/firestore");function Sr(){return Dr.logLevel}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=u.DEBUG&&(e=n.map(Ur),Dr.debug.apply(Dr,s(["Firestore (8.1.2): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=u.ERROR&&(e=n.map(Ur),Dr.error.apply(Dr,s(["Firestore (8.1.2): "+t],e)))}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=u.WARN&&(e=n.map(Ur),Dr.warn.apply(Dr,s(["Firestore (8.1.2): "+t],e)))}function Ur(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function jr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.1.2) INTERNAL ASSERTION FAILED: "+t;throw Pr(t),new Error(t)}function Mr(t){t||jr()}function xr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var qr,Fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=(n(Jr,qr=Error),Jr),zr=(Kr.prototype.getToken=function(){return Promise.resolve(null)},Kr.prototype.A=function(){},Kr.prototype.I=function(t){(this.T=t)(_r.UNAUTHENTICATED)},Kr.prototype.R=function(){this.T=null},Kr),Br=(Qr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Lr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Mr("string"==typeof t.accessToken),new xr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Qr.prototype.A=function(){this.forceRefresh=!0},Qr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},Qr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},Qr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Mr(null===t||"string"==typeof t),new _r(t)},Qr),Hr=(Object.defineProperty(Xr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Xr),Wr=(Yr.prototype.getToken=function(){return Promise.resolve(new Hr(this.v,this.C))},Yr.prototype.I=function(t){t(_r._)},Yr.prototype.R=function(){},Yr.prototype.A=function(){},Yr);function Yr(t,e){this.v=t,this.C=e}function Xr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=_r._}function Qr(t){var e=this;this.P=null,this.currentUser=_r.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Kr(){this.T=null}function Jr(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var $r=(Zr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Zr);function Zr(){}function ti(t,e){return t<e?-1:e<t?1:0}function ei(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var ni,ri,ii=(yi.now=function(){return yi.fromMillis(Date.now())},yi.fromDate=function(t){return yi.fromMillis(t.getTime())},yi.fromMillis=function(t){var e=Math.floor(t/1e3);return new yi(e,1e6*(t-1e3*e))},yi.prototype.toDate=function(){return new Date(this.toMillis())},yi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},yi.prototype.D=function(t){return this.seconds===t.seconds?ti(this.nanoseconds,t.nanoseconds):ti(this.seconds,t.seconds)},yi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},yi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},yi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},yi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},yi),oi=(di.N=function(t){return new di(t)},di.min=function(){return new di(new ii(0,0))},di.prototype.F=function(t){return this.timestamp.D(t.timestamp)},di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},di.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},di.prototype.L=function(){return this.timestamp},di),Ie=(Object.defineProperty(pi.prototype,"length",{get:function(){return this.$},enumerable:!1,configurable:!0}),pi.prototype.isEqual=function(t){return 0===pi.k(this,t)},pi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof pi?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},pi.prototype.limit=function(){return this.offset+this.length},pi.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},pi.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},pi.prototype.B=function(){return this.segments[this.offset]},pi.prototype.j=function(){return this.get(this.length-1)},pi.prototype.get=function(t){return this.segments[this.offset+t]},pi.prototype.W=function(){return 0===this.length},pi.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},pi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},pi.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},pi),si=(n(fi,ri=Ie),fi.prototype.M=function(t,e,n){return new fi(t,e,n)},fi.prototype.Y=function(){return this.H().join("/")},fi.prototype.toString=function(){return this.Y()},fi.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new fi(n)},fi.X=function(){return new fi([])},fi),ui=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ai=(n(li,ni=Ie),li.prototype.M=function(t,e,n){return new li(t,e,n)},li.Z=function(t){return ui.test(t)},li.prototype.Y=function(){return this.H().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),li.Z(t)||(t="`"+t+"`"),t}).join(".")},li.prototype.toString=function(){return this.Y()},li.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},li.nt=function(){return new li(["__name__"])},li.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Gr(Fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(Fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Gr(Fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new li(e)},li.X=function(){return new li([])},li),hi=(ci.st=function(t){return new ci(si.J(t))},ci.it=function(t){return new ci(si.J(t).U(5))},ci.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ci.prototype.isEqual=function(t){return null!==t&&0===si.k(this.path,t.path)},ci.prototype.toString=function(){return this.path.toString()},ci.k=function(t,e){return si.k(t.path,e.path)},ci.ot=function(t){return t.length%2==0},ci.ut=function(t){return new ci(new si(t.slice()))},ci);function ci(t){this.path=t}function li(){return null!==ni&&ni.apply(this,arguments)||this}function fi(){return null!==ri&&ri.apply(this,arguments)||this}function pi(t,e,n){void 0===e?e=0:e>t.length&&jr(),void 0===n?n=t.length-e:n>t.length-e&&jr(),this.segments=t,this.offset=e,this.$=n}function di(t){this.timestamp=t}function yi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function vi(t){return null==t}function gi(t){return 0===t&&1/t==-1/0}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.Y()+t.op.toString()+Ao(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.Y()+t.dir}).join(","),vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=$u(e.startAt)),e.endAt&&(t+="|ub:",t+=$u(e.endAt)),e.ct=t),e.ct}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Eo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ta(t.startAt,e.startAt)&&ta(t.endAt,e.endAt)}function Ti(t){return hi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ii=(Ni.fromBase64String=function(t){return new Ni(atob(t))},Ni.fromUint8Array=function(t){return new Ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ni.prototype.toBase64=function(){return t=this.ht,btoa(t);var t},Ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.ht)},Ni.prototype.at=function(){return 2*this.ht.length},Ni.prototype.F=function(t){return ti(this.ht,t.ht)},Ni.prototype.isEqual=function(t){return this.ht===t.ht},Ni);function Ni(t){this.ht=t}Ii.lt=new Ii("");function Ai(t){this.count=t}var Ci,Oi=(_i.prototype.dt=function(t){return new _i(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},_i.prototype.wt=function(t,e){return new _i(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},_i.prototype.Et=function(t){return new _i(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},_i);function _i(t,e,n,r,i,o,s){void 0===i&&(i=oi.min()),void 0===o&&(o=oi.min()),void 0===s&&(s=Ii.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ki(t){switch(t){case Fr.OK:return jr(),0;case Fr.CANCELLED:case Fr.UNKNOWN:case Fr.DEADLINE_EXCEEDED:case Fr.RESOURCE_EXHAUSTED:case Fr.INTERNAL:case Fr.UNAVAILABLE:case Fr.UNAUTHENTICATED:return;case Fr.INVALID_ARGUMENT:case Fr.NOT_FOUND:case Fr.ALREADY_EXISTS:case Fr.PERMISSION_DENIED:case Fr.FAILED_PRECONDITION:case Fr.ABORTED:case Fr.OUT_OF_RANGE:case Fr.UNIMPLEMENTED:case Fr.DATA_LOSS:return 1;default:return jr(),0}}function Ri(t){if(void 0===t)return Pr("GRPC error has no .code"),Fr.UNKNOWN;switch(t){case Ci.OK:return Fr.OK;case Ci.CANCELLED:return Fr.CANCELLED;case Ci.UNKNOWN:return Fr.UNKNOWN;case Ci.DEADLINE_EXCEEDED:return Fr.DEADLINE_EXCEEDED;case Ci.RESOURCE_EXHAUSTED:return Fr.RESOURCE_EXHAUSTED;case Ci.INTERNAL:return Fr.INTERNAL;case Ci.UNAVAILABLE:return Fr.UNAVAILABLE;case Ci.UNAUTHENTICATED:return Fr.UNAUTHENTICATED;case Ci.INVALID_ARGUMENT:return Fr.INVALID_ARGUMENT;case Ci.NOT_FOUND:return Fr.NOT_FOUND;case Ci.ALREADY_EXISTS:return Fr.ALREADY_EXISTS;case Ci.PERMISSION_DENIED:return Fr.PERMISSION_DENIED;case Ci.FAILED_PRECONDITION:return Fr.FAILED_PRECONDITION;case Ci.ABORTED:return Fr.ABORTED;case Ci.OUT_OF_RANGE:return Fr.OUT_OF_RANGE;case Ci.UNIMPLEMENTED:return Fr.UNIMPLEMENTED;case Ci.DATA_LOSS:return Fr.DATA_LOSS;default:return jr()}}(l=Ci=Ci||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Di=(Ui.prototype.Tt=function(t,e){return new Ui(this.k,this.root.Tt(t,e,this.k).copy(null,null,Li.At,null,null))},Ui.prototype.remove=function(t){return new Ui(this.k,this.root.remove(t,this.k).copy(null,null,Li.At,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype.W=function(){return this.root.W()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.It=function(){return this.root.It()},Ui.prototype.Rt=function(){return this.root.Rt()},Ui.prototype.Pt=function(t){return this.root.Pt(t)},Ui.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.yt=function(t){return this.root.yt(t)},Ui.prototype.Vt=function(){return new Si(this.root,null,this.k,!1)},Ui.prototype.gt=function(t){return new Si(this.root,t,this.k,!1)},Ui.prototype.vt=function(){return new Si(this.root,null,this.k,!0)},Ui.prototype.bt=function(t){return new Si(this.root,t,this.k,!0)},Ui),Si=(Vi.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Vi.prototype.Nt=function(){return 0<this.St.length},Vi.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Vi),Li=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype.W=function(){return!1},Pi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Pi.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Pi.prototype.min=function(){return this.left.W()?this:this.left.min()},Pi.prototype.It=function(){return this.min().key},Pi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Pi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Pi.prototype.Ot=function(){if(this.left.W())return Pi.EMPTY;var t=this;return t.left.Lt()||t.left.left.Lt()||(t=t.$t()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Lt()||r.left.left.Lt()||(r=r.$t()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Lt()&&(r=r.kt()),r.right.W()||r.right.Lt()||r.right.left.Lt()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Pi.prototype.Lt=function(){return this.color},Pi.prototype.Ft=function(){var t=this;return t.right.Lt()&&!t.left.Lt()&&(t=t.Ut()),t.left.Lt()&&t.left.left.Lt()&&(t=t.kt()),t.left.Lt()&&t.right.Lt()&&(t=t.qt()),t},Pi.prototype.$t=function(){var t=this.qt();return t.right.left.Lt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Pi.prototype.Mt=function(){var t=this.qt();return t.left.left.Lt()&&(t=(t=t.kt()).qt()),t},Pi.prototype.Ut=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.kt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Pi.prototype.Qt=function(){if(this.Lt()&&this.left.Lt())throw jr();if(this.right.Lt())throw jr();var t=this.left.Qt();if(t!==this.right.Qt())throw jr();return t+(this.Lt()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Vi(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Ui(t,e){this.k=t,this.root=e||Li.EMPTY}function ji(){this.size=0}Li.EMPTY=null,Li.RED=!0,Li.At=!1,Li.EMPTY=(Object.defineProperty(ji.prototype,"key",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"value",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"color",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"left",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"right",{get:function(){throw jr()},enumerable:!1,configurable:!0}),ji.prototype.copy=function(t,e,n,r,i){return this},ji.prototype.Tt=function(t,e,n){return new Li(t,e)},ji.prototype.remove=function(t,e){return this},ji.prototype.W=function(){return!0},ji.prototype.Pt=function(t){return!1},ji.prototype.yt=function(t){return!1},ji.prototype.It=function(){return null},ji.prototype.Rt=function(){return null},ji.prototype.Lt=function(){return!1},ji.prototype.Bt=function(){return!0},ji.prototype.Qt=function(){return 0},new ji);var Mi=(Gi.prototype.has=function(t){return null!==this.data.get(t)},Gi.prototype.first=function(){return this.data.It()},Gi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Gi.prototype.indexOf=function(t){return this.data.indexOf(t)},Gi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Gi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Gi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Gi.prototype.Gt=function(t){t=this.data.gt(t);return t.Nt()?t.Dt().key:null},Gi.prototype.Vt=function(){return new xi(this.data.Vt())},Gi.prototype.gt=function(t){return new xi(this.data.gt(t))},Gi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Gi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Gi.prototype.W=function(){return this.data.W()},Gi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Gi.prototype.isEqual=function(t){if(!(t instanceof Gi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Gi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Gi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Gi.prototype.copy=function(t){var e=new Gi(this.k);return e.data=t,e},Gi),xi=(Fi.prototype.Dt=function(){return this.zt.Dt().key},Fi.prototype.Nt=function(){return this.zt.Nt()},Fi),qi=new Di(hi.k);function Fi(t){this.zt=t}function Gi(t){this.k=t,this.data=new Di(this.k)}var zi=new Di(hi.k);var Bi=new Di(hi.k),Hi=new Mi(hi.k);function Wi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Hi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Yi=new Mi(ti);var Xi=(co.Jt=function(t){return new co(t.k)},co.prototype.has=function(t){return null!=this.Ht.get(t)},co.prototype.get=function(t){return this.Ht.get(t)},co.prototype.first=function(){return this.Yt.It()},co.prototype.last=function(){return this.Yt.Rt()},co.prototype.W=function(){return this.Yt.W()},co.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Yt.indexOf(t):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.k=this.k,n.Ht=t,n.Yt=e,n},co),Qi=(ho.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):jr()},ho.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},ho),Ki=(ao.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Xi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&Eu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),Ji=(uo.an=function(t,e){var n=new Map;return n.set(t,$i.ln(t,e)),new uo(oi.min(),n,Yi,qi,Wi())},uo),$i=(so.ln=function(t,e){return new so(Ii.lt,e,Wi(),Wi(),Wi())},so),Zi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},to=function(t,e){this.targetId=t,this.Tn=e},eo=function(t,e,n,r){void 0===n&&(n=Ii.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},no=(Object.defineProperty(oo.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),oo.prototype.gn=function(t){0<t.at()&&(this.yn=!0,this.Rn=t)},oo.prototype.vn=function(){var n=Wi(),r=Wi(),i=Wi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:jr()}}),new $i(this.Rn,this.Pn,n,r,i)},oo.prototype.bn=function(){this.yn=!1,this.In=fo()},oo.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},oo.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},oo.prototype.Dn=function(){this.An+=1},oo.prototype.Nn=function(){--this.An},oo.prototype.xn=function(){this.yn=!0,this.Pn=!0},oo),ro=(io.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof ou?this.Un(r,t.mn):t.mn instanceof su&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},io.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:jr()}})},io.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},io.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count,t=this.zn(e);t&&(Ti(t=t.target)?0===n?(t=new hi(t.path),this.qn(e,t,new su(t,oi.min()))):Mr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},io.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&Ti(n.target)&&(n=new hi(n.target.path),null!==i.Ln.get(n)||i.Jn(e,n)||i.qn(e,n,new su(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Wi();this.$n.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.zn(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Ji(r,o,this.kn,this.Ln,s);return this.Ln=qi,this.$n=lo(),this.kn=new Mi(ti),t},io.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.Ln=this.Ln.Tt(e.key,e),this.$n=this.$n.Tt(e.key,this.Xn(e.key).add(t)))},io.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.$n=this.$n.Tt(e,this.Xn(e).delete(t)),n&&(this.Ln=this.Ln.Tt(e,n)))},io.prototype.removeTarget=function(t){this.On.delete(t)},io.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},io.prototype.Dn=function(t){this.jn(t).Dn()},io.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new no,this.On.set(t,e)),e},io.prototype.Xn=function(t){var e=this.$n.get(t);return e||(e=new Mi(ti),this.$n=this.$n.Tt(t,e)),e},io.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Lr("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},io.prototype.Gn=function(e){var n=this;this.On.set(e,new no),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},io.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},io);function io(t){this.Fn=t,this.On=new Map,this.Ln=qi,this.$n=lo(),this.kn=new Mi(ti)}function oo(){this.An=0,this.In=fo(),this.Rn=Ii.lt,this.Pn=!1,this.yn=!0}function so(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function uo(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.hn=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function ho(){this.Xt=new Di(hi.k)}function co(n){this.k=n?function(t,e){return n(t,e)||hi.k(t.key,e.key)}:function(t,e){return hi.k(t.key,e.key)},this.Ht=zi,this.Yt=new Di(this.k)}function lo(){return new Di(hi.k)}function fo(){return new Di(hi.k)}function po(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function yo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function vo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function go(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function mo(t){t=Co(t.mapValue.fields.__local_write_time__.timestampValue);return new ii(t.seconds,t.nanos)}var wo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?go(t)?4:10:jr()}function Eo(r,i){var t,e=bo(r);if(e!==bo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return mo(r).isEqual(mo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Co(r.timestampValue),t=Co(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,_o(r.bytesValue).isEqual(_o(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Oo((t=r).geoPointValue.latitude)===Oo(e.geoPointValue.latitude)&&Oo(t.geoPointValue.longitude)===Oo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Oo(t.integerValue)===Oo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Oo(t.doubleValue),e=Oo(e.doubleValue);return t===e?gi(t)===gi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return ei(r.arrayValue.values||[],i.arrayValue.values||[],Eo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(po(e)!==po(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Eo(e[t],n[t])))return!1;return!0}();default:return jr()}}function To(t,e){return void 0!==(t.values||[]).find(function(t){return Eo(t,e)})}function Io(t,e){var n,r,i=bo(t),o=bo(e);if(i!==o)return ti(i,o);switch(i){case 0:return 0;case 1:return ti(t.booleanValue,e.booleanValue);case 2:return n=e,r=Oo(t.integerValue||t.doubleValue),n=Oo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return No(t.timestampValue,e.timestampValue);case 4:return No(mo(t),mo(e));case 5:return ti(t.stringValue,e.stringValue);case 6:return function(t,e){t=_o(t),e=_o(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ti(n[i],r[i]);if(0!==o)return o}return ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=ti(Oo(i.latitude),Oo(r.latitude)))?n:ti(Oo(i.longitude),Oo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Io(n[i],r[i]);if(o)return o}return ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ti(r[s],o[s]);if(0!==u)return u;u=Io(n[r[s]],i[o[s]]);if(0!==u)return u}return ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw jr()}}function No(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ti(t,e);var n=Co(t),t=Co(e),e=ti(n.seconds,t.seconds);return 0!==e?e:ti(n.nanos,t.nanos)}function Ao(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Co(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?_o(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,hi.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):jr();var e}(t)}function Co(t){if(Mr(!!t),"string"!=typeof t)return{seconds:Oo(t.seconds),nanos:Oo(t.nanos)};var e=0,n=wo.exec(t);Mr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Oo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _o(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function ko(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function Ro(t){return t&&"integerValue"in t}function Do(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function Lo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Po(t){return t&&"mapValue"in t}var Vo={asc:"ASCENDING",desc:"DESCENDING"},Uo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jo=function(t,e){this.t=t,this.ne=e};function Mo(t){return{integerValue:""+t}}function xo(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function qo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Mo(e):xo(t,e);var n}function Fo(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Go(t,e){return t.ne?e.toBase64():e.toUint8Array()}function zo(t){return Mr(!!t),oi.N((t=Co(t),new ii(t.seconds,t.nanos)))}function Bo(t,e){return new si(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function Ho(t){t=si.J(t);return Mr(ss(t)),t}function Wo(t,e){return Bo(t.t,e.path)}function Yo(t,e){e=Ho(e);if(e.get(1)!==t.t.projectId)throw new Gr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Gr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new hi(Ko(e))}function Xo(t,e){return Bo(t.t,e)}function Qo(t){return new si(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Ko(t){return Mr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Jo(t,e,n){return{name:Wo(t,e),fields:n.proto.mapValue.fields}}function $o(t,e){var n,r,i;if(e instanceof js)n={update:Jo(t,e.key,e.value)};else if(e instanceof Xs)n={delete:Wo(t,e.key)};else if(e instanceof Ms)n={update:Jo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof zs)n={transform:{document:Wo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof cs)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof ls)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof vs)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof bs)return{fieldPath:t.field.Y(),increment:e.se};throw jr()})}};else{if(!(e instanceof Qs))return jr();n={verify:Wo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:(e=t,t=i.updateTime,Fo(e,t.L()))}:void 0!==i.exists?{exists:i.exists}:jr()),n}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xo(t,r.q()),n.structuredQuery.from=[{collectionId:r.j()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Lo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rs(t.field),op:(e=t.op,Uo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:rs((t=t).field),direction:(t=t.dir,Vo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.ne||vi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=es(e.endAt)),n}function ts(t){var e=4===(o=Ho(t.parent)).length?si.X():Ko(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Mr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[os(t)]:void 0!==t.fieldFilter?[(n=t,Ou.create(is(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return jr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):jr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ea(is((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=vi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ns(n.startAt));var u=null;return n.endAt&&(u=ns(n.endAt)),new au(e,i,t,o,r,"F",s,u)}function es(t){return{before:t.before,values:t.position}}function ns(t){var e=!!t.before,t=t.values||[];return new Yu(t,e)}function rs(t){return{fieldPath:t.Y()}}function is(t){return ai.et(t.fieldPath)}function os(t){switch(t.unaryFilter.op){case"IS_NAN":var e=is(t.unaryFilter.field);return Ou.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=is(t.unaryFilter.field);return Ou.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=is(t.unaryFilter.field);return Ou.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=is(t.unaryFilter.field);return Ou.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return jr()}}function ss(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}Ie=function(){this.oe=void 0};function us(t,e){return t instanceof bs?Ro(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var as,hs,cs=(n(ps,hs=Ie),ps),ls=(n(fs,as=Ie),fs);function fs(t){var e=this;return(e=as.call(this)||this).elements=t,e}function ps(){return null!==hs&&hs.apply(this,arguments)||this}function ds(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Eo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ys,vs=(n(gs,ys=Ie),gs);function gs(t){var e=this;return(e=ys.call(this)||this).elements=t,e}function ms(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Eo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ws,bs=(n(Es,ws=Ie),Es);function Es(t,e){var n=this;return(n=ws.call(this)||this).serializer=t,n.se=e,n}function Ts(t){return Oo(t.integerValue||t.doubleValue)}function Is(t){return Do(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ns(t,e){this.field=t,this.transform=e}var As=(Cs.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},Cs.prototype.isEqual=function(t){return ei(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Cs);function Cs(t){(this.fields=t).sort(ai.k)}function Os(t,e){this.version=t,this.transformResults=e}var _s=(ks.ce=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function Rs(t,e){return void 0!==t.updateTime?e instanceof ou&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ou}l=function(){};function Ds(t,e,n){return t instanceof js?new ou(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ms?function(t,e,n){if(!Rs(t.re,e))return new uu(t.key,n.version);e=Fs(t,e);return new ou(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof zs?function(t,e,n){if(Mr(null!=n.transformResults),!Rs(t.re,e))return new uu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Mr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ou&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ls?ds(o,s):o instanceof vs?ms(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Hs(t,r.data(),e);return new ou(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new su(t.key,n.version,{hasCommittedMutations:!0})}function Ss(t,e,n,r){return t instanceof js?function(t,e){if(!Rs(t.re,e))return e;e=Ps(e);return new ou(t.key,e,t.value,{he:!0})}(t,e):t instanceof Ms?function(t,e){if(!Rs(t.re,e))return e;var n=Ps(e),e=Fs(t,e);return new ou(t.key,n,e,{he:!0})}(t,e):t instanceof zs?function(t,e,n,r){if(!Rs(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof ou&&(c=n.field(a.field)),null===c&&r instanceof ou&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof cs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ls?ds(h,i):h instanceof vs?ms(h,i):(h=us(c=h,i),i=Ts(h)+Ts(c.se),Ro(h)&&Ro(c.se)?Mo(i):xo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Hs(t,i.data(),r);return new ou(t.key,i.version,r,{he:!0})}(t,e,r,n):(e=e,Rs((t=t).re,e)?new su(t.key,oi.min()):e)}function Ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||ei(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ls&&e instanceof ls||t instanceof vs&&e instanceof vs?ei(t.elements,e.elements,Eo):t instanceof bs&&e instanceof bs?Eo(t.se,e.se):t instanceof cs&&e instanceof cs)}))}function Ps(t){return t instanceof ou?t.version:oi.min()}var Vs,Us,js=(n(qs,Us=l),qs),Ms=(n(xs,Vs=l),xs);function xs(t,e,n,r){var i=this;return(i=Vs.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function qs(t,e,n){var r=this;return(r=Us.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Fs(t,e){return n=t,e=e instanceof ou?e.data():Ks.empty(),r=new Js(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ae();var n,r}var Gs,zs=(n(Bs,Gs=l),Bs);function Bs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=_s.exists(!0),n}function Hs(t,e,n){for(var r=new Js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ae()}var Ws,Ys,Xs=(n(eu,Ys=l),eu),Qs=(n(tu,Ws=l),tu),Ks=(Zs.empty=function(){return new Zs({mapValue:{}})},Zs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Zs.prototype.isEqual=function(t){return Eo(this.proto,t.proto)},Zs),Js=($s.prototype.set=function(t,e){return this.fe(t,e),this},$s.prototype.delete=function(t){return this.fe(t,null),this},$s.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===bo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},$s.prototype.ae=function(){var t=this.de(ai.X(),this._e);return null!=t?new Ks(t):this.le},$s.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Po(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},$s);function $s(t){void 0===t&&(t=Ks.empty()),this.le=t,this._e=new Map}function Zs(t){this.proto=t}function tu(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.re=e,n.type=4,n}function eu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.re=e,n.type=3,n}var nu,ru,iu,Ie=function(t,e){this.key=t,this.version=e},ou=(n(lu,iu=Ie),lu.prototype.field=function(t){return this.we.field(t)},lu.prototype.data=function(){return this.we},lu.prototype.Ee=function(){return this.we.proto},lu.prototype.isEqual=function(t){return t instanceof lu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.he===t.he&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},lu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.he+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.he||this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu),su=(n(cu,ru=Ie),cu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),uu=(n(hu,nu=Ie),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu),au=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function hu(){return null!==nu&&nu.apply(this,arguments)||this}function cu(t,e,n){var r=this;return(r=ru.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function lu(t,e,n,r){var i=this;return(i=iu.call(this,t,e)||this).we=n,i.he=!!r.he,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function fu(t){return new au(t)}function pu(t){return!vi(t.limit)&&"F"===t.limitType}function du(t){return!vi(t.limit)&&"L"===t.limitType}function yu(t){return 0<t.me.length?t.me[0].field:null}function vu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function gu(t){return null!==t.collectionGroup}function mu(t){var e=t;if(null===e.Te){e.Te=[];var n=vu(e),t=yu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new ea(n)),e.Te.push(new ea(ai.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new ea(ai.nt(),n)))}}return e.Te}function wu(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=wi(e.path,e.collectionGroup,mu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ea(o.field,s))}var u=e.endAt?new Yu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Yu(e.startAt.position,!e.startAt.before):null;e.Ae=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function bu(t,e,n){return new au(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return Ei(wu(t),wu(e))&&t.limitType===e.limitType}function Tu(t){return bi(wu(t))+"|lt:"+t.limitType}function Iu(t){return"Query(target="+(e=wu(t),n=e.path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.Y()+" "+t.op+" "+Ao(t.value)}).join(", ")+"]"),vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+$u(e.startAt)),e.endAt&&(n+=", endAt: "+$u(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Nu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):hi.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Zu(t.startAt,mu(t),n))&&(!t.endAt||!Zu(t.endAt,mu(t),n)));var e,n}function Au(u){return function(t,e){for(var n=!1,r=0,i=mu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?hi.k(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Io(n,t):jr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return jr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Cu,Ou=(n(_u,Cu=function(){}),_u.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new Su(t,e,n):"array-contains"===e?new zu(t,n):"in"===e?new Bu(t,n):"not-in"===e?new Hu(t,n):"array-contains-any"===e?new Wu(t,n):new _u(t,e,n)},_u.Re=function(t,e,n){return new("in"===e?Lu:Pu)(t,n)},_u.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pe(Io(t,this.value)):null!==t&&bo(this.value)===bo(t)&&this.Pe(Io(t,this.value))},_u.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return jr()}},_u.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},_u);function _u(t,e,n){var r=this;return(r=Cu.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,Ru,Du,Su=(n(ju,Du=Ou),ju.prototype.matches=function(t){t=hi.k(t.key,this.key);return this.Pe(t)},ju),Lu=(n(Uu,Ru=Ou),Uu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Uu),Pu=(n(Vu,ku=Ou),Vu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Vu);function Vu(t,e){var n=this;return(n=ku.call(this,t,"not-in",e)||this).keys=Mu(0,e),n}function Uu(t,e){var n=this;return(n=Ru.call(this,t,"in",e)||this).keys=Mu(0,e),n}function ju(t,e,n){var r=this;return(r=Du.call(this,t,e,n)||this).key=hi.it(n.referenceValue),r}function Mu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return hi.it(t.referenceValue)})}var xu,qu,Fu,Gu,zu=(n(Ju,Gu=Ou),Ju.prototype.matches=function(t){t=t.field(this.field);return Do(t)&&To(t.arrayValue,this.value)},Ju),Bu=(n(Ku,Fu=Ou),Ku.prototype.matches=function(t){t=t.field(this.field);return null!==t&&To(this.value.arrayValue,t)},Ku),Hu=(n(Qu,qu=Ou),Qu.prototype.matches=function(t){if(To(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!To(this.value.arrayValue,t)},Qu),Wu=(n(Xu,xu=Ou),Xu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Do(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return To(e.value.arrayValue,t)})},Xu),Yu=function(t,e){this.position=t,this.before=e};function Xu(t,e){return xu.call(this,t,"array-contains-any",e)||this}function Qu(t,e){return qu.call(this,t,"not-in",e)||this}function Ku(t,e){return Fu.call(this,t,"in",e)||this}function Ju(t,e){return Gu.call(this,t,"array-contains",e)||this}function $u(t){return(t.before?"b":"a")+":"+t.position.map(Ao).join(",")}function Zu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?hi.k(hi.it(s.referenceValue),n.key):Io(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ta(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Eo(t.position[n],e.position[n]))return!1;return!0}var ea=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var na=(ca.prototype.Ve=function(t,e,n){for(var r=n.pe,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ds(o,e,r[i]))}return e},ca.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ss(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ss(a,e,o,this.ye))}return e},ca.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},ca.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Wi())},ca.prototype.isEqual=function(t){return this.batchId===t.batchId&&ei(this.mutations,t.mutations,Ls)&&ei(this.baseMutations,t.baseMutations,Ls)},ca),ra=(ha.from=function(t,e,n){Mr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new ha(t,e,n,r)},ha),ia=(aa.prototype.get=function(t){var e=this.Se(t),e=this.Ne[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.De(o,t))return i}},aa.prototype.has=function(t){return void 0!==this.get(t)},aa.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},aa.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},aa.prototype.forEach=function(s){yo(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},aa.prototype.W=function(){return vo(this.Ne)},aa),oa=(ua.prototype.catch=function(t){return this.next(void 0,t)},ua.prototype.next=function(r,i){var o=this;return this.Le&&jr(),this.Le=!0,this.Oe?this.error?this.$e(i,this.error):this.ke(r,this.result):new ua(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.$e(i,t).next(e,n)}})},ua.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ua.prototype.Ue=function(t){try{var e=t();return e instanceof ua?e:ua.resolve(e)}catch(t){return ua.reject(t)}},ua.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):ua.resolve(e)},ua.prototype.$e=function(t,e){return t?this.Ue(function(){return t(e)}):ua.reject(e)},ua.resolve=function(n){return new ua(function(t,e){t(n)})},ua.reject=function(n){return new ua(function(t,e){e(n)})},ua.qe=function(t){return new ua(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ua.Be=function(t){for(var n=ua.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ua.resolve(t):e()})}(r[e]);return n},ua.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},ua),sa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ua(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.Le=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function aa(t,e){this.Se=t,this.De=e,this.Ne={}}function ha(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function ca(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function la(t){return new jo(t,!0)}function fa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var pa=(ma.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},ma.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},ma.prototype.Ye=function(t,e,i){var o=qi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},ma.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},ma.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=qi;return t.forEach(function(t,e){e=e||new su(t,oi.min()),n=n.Tt(t,e)}),n})},ma.prototype.ts=function(t,e,n){return r=e,hi.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):gu(e)?this.es(t,e,n):this.ss(t,e,n);var r},ma.prototype.ns=function(t,e){return this.Ge(t,new hi(e)).next(function(t){var e=zi;return t instanceof ou&&(e=e.Tt(t.key,t)),e})},ma.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=zi;return this.We.rs(n,s).next(function(t){return oa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new au(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},ma.prototype.ss=function(e,n,t){var h,c,r=this;return this.Qe.ts(e,n,t).next(function(t){return h=t,r.je.os(e,n)}).next(function(t){return c=t,r.us(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Ss(s,a,a,r.ye);h=a instanceof ou?h.Tt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Nu(n,e)||(h=h.remove(t))}),h})},ma.prototype.us=function(t,e,n){for(var r=Wi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ou&&(h=h.Tt(t,e))}),h})},ma),da=(ga.ls=function(t,e){for(var n=Wi(),r=Wi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ga(t,e.fromCache,n,r)},ga),ya=(va.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},va.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},va);function va(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function ga(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function ma(t,e,n){this.Qe=t,this.je=e,this.We=n}ya.Es=-1;var wa=(ba.prototype.reset=function(){this.ys=0},ba.prototype.gs=function(){this.ys=this.Ps},ba.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Lr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ba.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ba.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ba.prototype.bs=function(){return(Math.random()-.5)*this.ys},ba);function ba(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function Ea(t){return"IndexedDbTransactionError"===t.name}function Ta(){return"undefined"!=typeof document?document:null}var Ia=(Ca.Ls=function(t,e,n,r,i){i=new Ca(t,e,Date.now()+n,r,i);return i.start(n),i},Ca.prototype.start=function(t){var e=this;this.$s=setTimeout(function(){return e.ks()},t)},Ca.prototype.Ds=function(){return this.ks()},Ca.prototype.cancel=function(t){null!==this.$s&&(this.clearTimeout(),this.Os.reject(new Gr(Fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ca.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.$s?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},Ca.prototype.clearTimeout=function(){null!==this.$s&&(this.Fs(this),clearTimeout(this.$s),this.$s=null)},Ca),Na=(Object.defineProperty(Aa.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),Aa.prototype.Ms=function(t){this.enqueue(t)},Aa.prototype.Ys=function(t){this.Js(),this.Xs(t)},Aa.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=Ta())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},Aa.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},Aa.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},Aa.prototype.ni=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!Ea(e=t.sent()))throw e;return Lr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},Aa.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},Aa.prototype.Cs=function(t,e,n){var r=this;this.Js(),-1<this.Gs.indexOf(t)&&(e=0);n=Ia.Ls(this,t,e,n,function(t){return r.ei(t)});return this.Qs.push(n),n},Aa.prototype.Js=function(){this.js&&jr()},Aa.prototype.si=function(){},Aa.prototype.ii=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},Aa.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},Aa.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},Aa.prototype.ui=function(t){this.Gs.push(t)},Aa.prototype.ei=function(t){t=this.Qs.indexOf(t);this.Qs.splice(t,1)},Aa);function Aa(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new wa(this,"async_queue_retry"),this.zs=function(){var t=Ta();t&&Lr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=Ta();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function Ca(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new sa,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function Oa(t,e){if(Pr("AsyncQueue",e+": "+t),Ea(t))return new Gr(Fr.UNAVAILABLE,e+": "+t);throw t}function _a(t){this.fi=t}var ka=(Ra.prototype.ci=function(t){this.hi=t},Ra.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(oi.min())?this.ai(e,r):this.hi.Je(e,o).next(function(t){var n=s.li(r,t);return(pu(r)||du(r))&&s._i(r.limitType,n,o,i)?s.ai(e,r):(Sr()<=u.DEBUG&&Lr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Iu(r)),s.hi.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Ra.prototype.li=function(n,t){var r=new Mi(Au(n));return t.forEach(function(t,e){e instanceof ou&&Nu(n,e)&&(r=r.add(e))}),r},Ra.prototype._i=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},Ra.prototype.ai=function(t,e){return Sr()<=u.DEBUG&&Lr("QueryEngine","Using full collection scan to execute query:",Iu(e)),this.hi.ts(t,e,oi.min())},Ra);function Ra(){}var Da=(Ma.prototype.wi=function(t,e){return this.di.add(e),oa.resolve()},Ma.prototype.rs=function(t,e){return oa.resolve(this.di.getEntries(e))},Ma),Sa=(ja.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Mi(si.k),t=!r.has(n);return this.index[e]=r.add(n),t},ja.prototype.has=function(t){var e=t.j(),t=t.q(),e=this.index[e];return e&&e.has(t)},ja.prototype.getEntries=function(t){return(this.index[t]||new Mi(si.k)).H()},ja),La=(Ua.prototype.next=function(){return this.Ei+=2,this.Ei},Ua.mi=function(){return new Ua(0)},Ua.Ti=function(){return new Ua(-1)},Ua),Pa=(Va.prototype.Ni=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.xi(t,n.Ii)})},Va);function Va(t,e,n,r){this.persistence=t,this.Ai=e,this.serializer=r,this.Ii=new Di(ti),this.Ri=new ia(bi,Ei),this.Pi=oi.min(),this.je=t.yi(n),this.Vi=t.pi(),this.gi=t.vi(),this.bi=new pa(this.Vi,this.je,this.persistence.Ci()),this.Si=t.Di(),this.Ai.ci(this.bi)}function Ua(t){this.Ei=t}function ja(){this.index={}}function Ma(){this.di=new Sa}function xa(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.bi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.je.Fi(v).next(function(t){return g=t,n=e.persistence.yi(o),m=new pa(e.Vi,n,e.persistence.Ci()),n.Fi(v)}).next(function(t){for(var e=[],n=[],r=Wi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Je(v,r).next(function(t){return{Oi:t,Li:e,$i:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.bi=m,e.Ai.ci(e.bi),r)]}})})}function qa(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Vi.ki({Mi:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=oa.resolve(),n.forEach(function(n){u=u.next(function(){return o.He(r,n)}).next(function(t){var e=t,t=i.Ce.get(n);Mr(null!==t),(!e||e.version.F(t)<0)&&(e=s.Ve(n,e,i))&&o.Ui(e,i.be)})}),u.next(function(){return e.je.qi(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.je.Bi(t)}).next(function(){return l.bi.Je(t,a)})})}function Fa(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.gi.Qi(t)})}function Ga(t,o){var c=t,l=o.ft,f=c.Ii;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Vi.ki({Mi:!0});f=c.Ii;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.gi.ji(s,t.wn,e).next(function(){return c.gi.Wi(s,t.fn,e)})),0<(i=t.resumeToken).at()&&(n=o.wt(i,l).dt(s.Gi),f=f.Tt(e,n),r=o,i=t,Mr(0<(o=n).resumeToken.at()),(0===r.resumeToken.at()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.gi.Ki(s,n))))});var e,a,n,h,r,i=qi;return o.cn.forEach(function(t,e){o.hn.has(t)&&u.push(c.persistence.Hi.zi(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Wi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=qi;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof su&&e.version.isEqual(oi.min())?(a.Yi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.Ui(e,r),o=o.Tt(t,e)):Lr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(oi.min())||(e=c.gi.Qi(s).next(function(t){return c.gi.Ji(s,s.Gi,l)}),u.push(e)),oa.qe(u).next(function(){return t.apply(s)}).next(function(){return c.bi.Xe(s,i)})}).then(function(t){return c.Ii=f,t})}function za(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ii.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Hi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ea(r=t.sent()))throw r;return Lr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ii=e.Ii.remove(o),e.Ri.delete(n.target),[2]}})})}function Ba(t,o,s){var u=t,a=oi.min(),h=Wi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=wu(o),(void 0!==(t=(i=t).Ri.get(r))?oa.resolve(i.Ii.get(t)):i.gi.Zi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.gi.tr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ai.ts(e,o,s?a:oi.min(),s?h:Wi())}).next(function(t){return{documents:t,nr:h}});var t,n,r,i})}function Ha(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Fr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Lr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Wa(t,e,n,r,i){var o=this;this.zr=t,this.Hr=e,this.Ns=n,this.Yr={},this.Jr=[],this.Xr=new Map,this.Zr=new Set,this.no=[],this.eo=i,this.eo.so(function(t){n.Ms(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return ph(this)?(Lr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Zr.add(4),[4,sh(e)];case 1:return t.sent(),e.io.set("Unknown"),e.Zr.delete(4),[4,oh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.io=new Za(n,r)}var Ya,Xa,Qa,l=(ih.prototype.cr=function(){return 1===this.state||2===this.state||4===this.state},ih.prototype.hr=function(){return 2===this.state},ih.prototype.start=function(){3!==this.state?this.auth():this.ar()},ih.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ih.prototype.lr=function(){this.state=0,this.Ks.reset()},ih.prototype._r=function(){var t=this;this.hr()&&null===this.ur&&(this.ur=this.Ts.Cs(this.er,6e4,function(){return t.dr()}))},ih.prototype.wr=function(t){this.Er(),this.stream.send(t)},ih.prototype.dr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.hr()?[2,this.close(0)]:[2]})})},ih.prototype.Er=function(){this.ur&&(this.ur.cancel(),this.ur=null)},ih.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Er(),this.Ks.cancel(),this.rr++,3!==e?this.Ks.reset():n&&n.code===Fr.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===Fr.UNAUTHENTICATED&&this.ir.A(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tr(n)];case 1:return t.sent(),[2]}})})},ih.prototype.mr=function(){},ih.prototype.auth=function(){var n=this;this.state=1;var t=this.Ar(this.rr),e=this.rr;this.ir.getToken().then(function(t){n.rr===e&&n.Ir(t)},function(e){t(function(){var t=new Gr(Fr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Rr(t)})})},ih.prototype.Ir=function(t){var e=this,n=this.Ar(this.rr);this.stream=this.Pr(t),this.stream.yr(function(){n(function(){return e.state=2,e.listener.yr()})}),this.stream.Tr(function(t){n(function(){return e.Rr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ih.prototype.ar=function(){var t=this;this.state=4,this.Ks.vs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},ih.prototype.Rr=function(t){return Lr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ih.prototype.Ar=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.rr===e?t():(Lr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ih),Ka=(n(rh,Qa=l),rh.prototype.Pr=function(t){return this.sr.Vr("Listen",t)},rh.prototype.onMessage=function(t){this.Ks.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:jr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Mr(void 0===o||"string"==typeof o),Ii.fromBase64String(o||"")):(Mr(void 0===o||o instanceof Uint8Array),Ii.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Fr.UNKNOWN:Ri(s.code),new Gr(o,s.message||"")),r=new eo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Yo(t,u.document.name),a=zo(u.document.updateTime),s=new Ks({mapValue:{fields:u.document.fields}}),a=new ou(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Zi(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Yo(t,u.document),h=u.readTime?zo(u.readTime):oi.min(),h=new su(a,h),u=u.removedTargetIds||[];r=new Zi([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=Yo(t,h.document),h=h.removedTargetIds||[];r=new Zi([],h,c,null)}else{if(!("filter"in e))return jr();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Ai(e),c=c.targetId;r=new to(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return oi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?zo(t.readTime):oi.min()}(t);return this.listener.pr(e,t)},rh.prototype.gr=function(t){var e,n,r,i={};i.database=Qo(this.serializer),i.addTarget=(e=this.serializer,(r=Ti(r=(n=t).target)?{documents:{documents:[Xo(e,r.path)]}}:{query:Zo(e,r)}).targetId=n.targetId,0<n.resumeToken.at()?r.resumeToken=Go(e,n.resumeToken):0<n.ft.F(oi.min())&&(r.readTime=Fo(e,n.ft.L())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return jr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.wr(i)},rh.prototype.vr=function(t){var e={};e.database=Qo(this.serializer),e.removeTarget=t,this.wr(e)},rh),Ja=(n(nh,Xa=l),Object.defineProperty(nh.prototype,"Cr",{get:function(){return this.br},enumerable:!1,configurable:!0}),nh.prototype.start=function(){this.br=!1,this.lastStreamToken=void 0,Xa.prototype.start.call(this)},nh.prototype.mr=function(){this.br&&this.Sr([])},nh.prototype.Pr=function(t){return this.sr.Vr("Write",t)},nh.prototype.onMessage=function(t){if(Mr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.br){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Mr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?zo(t.updateTime):zo(e);n.isEqual(oi.min())&&(n=zo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Os(n,e)}(t,r)})):[]),n=zo(t.commitTime);return this.listener.Dr(n,e)}var n,r;return Mr(!t.writeResults||0===t.writeResults.length),this.br=!0,this.listener.Nr()},nh.prototype.Fr=function(){var t={};t.database=Qo(this.serializer),this.wr(t)},nh.prototype.Sr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return $o(e.serializer,t)})};this.wr(t)},nh),$a=(n(eh,Ya=function(){}),eh.prototype.Lr=function(){if(this.Or)throw new Gr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},eh.prototype.$r=function(e,n,r){var i=this;return this.Lr(),this.credentials.getToken().then(function(t){return i.sr.$r(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.A(),t})},eh.prototype.kr=function(e,n,r){var i=this;return this.Lr(),this.credentials.getToken().then(function(t){return i.sr.kr(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.A(),t})},eh.prototype.terminate=function(){this.Or=!1},eh),Za=(th.prototype.Qr=function(){var t=this;0===this.Ur&&(this.jr("Unknown"),this.qr=this.Ns.Cs("online_state_timeout",1e4,function(){return t.qr=null,t.Wr("Backend didn't respond within 10 seconds."),t.jr("Offline"),Promise.resolve()}))},th.prototype.Gr=function(t){"Online"===this.state?this.jr("Unknown"):(this.Ur++,1<=this.Ur&&(this.Kr(),this.Wr("Connection failed 1 times. Most recent error: "+t.toString()),this.jr("Offline")))},th.prototype.set=function(t){this.Kr(),this.Ur=0,"Online"===t&&(this.Br=!1),this.jr(t)},th.prototype.jr=function(t){t!==this.state&&(this.state=t,this.Mr(t))},th.prototype.Wr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Br?(Pr(t),this.Br=!1):Lr("OnlineStateTracker",t)},th.prototype.Kr=function(){null!==this.qr&&(this.qr.cancel(),this.qr=null)},th);function th(t,e){this.Ns=t,this.Mr=e,this.state="Unknown",this.Ur=0,this.qr=null,this.Br=!0}function eh(t,e,n){var r=this;return(r=Ya.call(this)||this).credentials=t,r.sr=e,r.serializer=n,r.Or=!1,r}function nh(t,e,n,r,i){var o=this;return(o=Xa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.br=!1,o}function rh(t,e,n,r,i){var o=this;return(o=Qa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function ih(t,e,n,r,i,o){this.Ts=t,this.er=n,this.sr=r,this.ir=i,this.listener=o,this.state=0,this.rr=0,this.ur=null,this.stream=null,this.Ks=new wa(t,e)}function oh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!ph(r))return[3,4];e=0,n=r.no,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.no,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function uh(t,e){t.Xr.has(e.targetId)||(t.Xr.set(e.targetId,e),fh(t)?lh(t):Eh(t).hr()&&hh(t,e))}function ah(t,e){var n=t,t=Eh(n);n.Xr.delete(e),t.hr()&&ch(n,e),0===n.Xr.size&&(t.hr()?t._r():ph(n)&&n.io.set("Unknown"))}function hh(t,e){t.ro.Dn(e.targetId),Eh(t).gr(e)}function ch(t,e){t.ro.Dn(e),Eh(t).vr(e)}function lh(e){e.ro=new ro({Zn:function(t){return e.Yr.Zn(t)},te:function(t){return e.Xr.get(t)||null}}),Eh(e).start(),e.io.Qr()}function fh(t){return ph(t)&&!Eh(t).cr()&&0<t.Xr.size}function ph(t){return 0===t.Zr.size}function dh(t){t.ro=void 0}function yh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.io.set("Online"),!(u instanceof eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Xr.has(i)?[4,o.Yr.oo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Xr.delete(i),o.ro.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Lr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,vh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Zi?s.ro.Mn(u):u instanceof to?s.ro.Kn(u):s.ro.Bn(u),a.isEqual(oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Fa(s.zr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).ro.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.at()&&((n=r.Xr.get(e))&&r.Xr.set(e,n.wt(t.resumeToken,i)))}),e.un.forEach(function(t){var e=r.Xr.get(t);e&&(r.Xr.set(t,e.wt(Ii.lt,e.ft)),ch(r,t),e=new Oi(e.target,t,1,e.sequenceNumber),hh(r,e))}),r.Yr.uo(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Lr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,vh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function vh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ea(r))throw r;return n.Zr.add(1),[4,sh(n)];case 1:return t.sent(),n.io.set("Offline"),i=i||function(){return Fa(n.zr)},n.Ns.ti(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Zr.delete(1),[4,oh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function gh(e,n){return n().catch(function(t){return vh(e,t,n)})}function mh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Th(i=a),s=0<i.Jr.length?i.Jr[i.Jr.length-1].batchId:-1,t.label=1;case 1:if(!(ph(i)&&i.Jr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.zr,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.je.Xi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Jr.length&&o._r(),[3,7]):(s=u.batchId,function(t,e){t.Jr.push(e);t=Th(t);t.hr()&&t.Cr&&t.Sr(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,vh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return wh(i)&&bh(i),[2]}var e,n,r})})}function wh(t){return ph(t)&&!Th(t).cr()&&0<t.Jr.length}function bh(t){Th(t).start()}function Eh(n){var t,e,r,i=this;return n.ao||(n.ao=(t=n.Hr,e=n.Ns,r={yr:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Xr.forEach(function(t,e){hh(n,t)}),[2]})})}.bind(null,n),Tr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return dh(e),fh(e)?(e.io.Gr(n),lh(e)):e.io.set("Unknown"),[2]})})}.bind(null,n),pr:yh.bind(null,n)},t.Lr(),new Ka(e,t.sr,t.credentials,t.serializer,r)),n.no.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ao.lr(),fh(n)?lh(n):n.io.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ao.stop()];case 2:t.sent(),dh(n),t.label=3;case 3:return[2]}})})})),n.ao}function Th(n){var t,e,r,i=this;return n.lo||(n.lo=(t=n.Hr,e=n.Ns,r={yr:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Th(e).Fr(),[2]})})}.bind(null,n),Tr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Th(e).Cr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return ki(n=i.code)&&n!==Fr.ABORTED?(e=r.Jr.shift(),Th(r).lr(),[4,gh(r,function(){return r.Yr.ho(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,mh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return wh(e)&&bh(e),[2]}})})}.bind(null,n),Nr:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Th(o),n=0,r=o.Jr;n<r.length;n++)i=r[n],e.Sr(i.mutations);return[2]})})}.bind(null,n),Dr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Jr.shift(),n=ra.from(e,i,o),[4,gh(r,function(){return r.Yr.co(n)})];case 1:return t.sent(),[4,mh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Lr(),new Ja(e,t.sr,t.credentials,t.serializer,r)),n.no.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.lo.lr(),[4,mh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.lo.stop()];case 3:t.sent(),0<n.Jr.length&&(Lr("RemoteStore","Stopping write stream with "+n.Jr.length+" pending writes"),n.Jr=[]),t.label=4;case 4:return[2]}})})})),n.lo}function Ih(){this.queries=new ia(Tu,Eu),this.onlineState="Unknown",this.fo=new Set}var Nh=function(){this._o=void 0,this.listeners=[]};function Ah(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Nh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.wo(n)];case 2:return o._o=t.sent(),[3,4];case 3:return o=t.sent(),o=Oa(o,"Initialization of query '"+Iu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Eo(e.onlineState),i._o&&u.mo(i._o)&&Oh(e),[2]}})})}function Ch(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.To(n))]:[2]})})}function Oh(t){t.fo.forEach(function(t){t.next()})}var _h=(Hh.prototype.mo=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ki(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Io?this.Po(t)&&(this.Ao.next(t),o=!0):this.yo(t,this.onlineState)&&(this.Vo(t),o=!0),this.Ro=t,o},Hh.prototype.onError=function(t){this.Ao.error(t)},Hh.prototype.Eo=function(t){this.onlineState=t;var e=!1;return this.Ro&&!this.Io&&this.yo(this.Ro,t)&&(this.Vo(this.Ro),e=!0),e},Hh.prototype.yo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.po&&n||t.docs.W()&&"Offline"!==e)},Hh.prototype.Po=function(t){if(0<t.docChanges.length)return!0;var e=this.Ro&&this.Ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},Hh.prototype.Vo=function(t){t=Ki.rn(t.query,t.docs,t.nn,t.fromCache),this.Io=!0,this.Ao.next(t)},Hh),kh=(Bh.prototype.W=function(){return this.vo.W()},Bh.prototype.Do=function(t,e){e=new Rh(t,e);this.vo=this.vo.add(e),this.Co=this.Co.add(e)},Bh.prototype.No=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},Bh.prototype.xo=function(t,e){this.Fo(new Rh(t,e))},Bh.prototype.Oo=function(t,e){var n=this;t.forEach(function(t){return n.xo(t,e)})},Bh.prototype.Lo=function(t){var e=this,n=new hi(new si([])),r=new Rh(n,t),t=new Rh(n,t+1),i=[];return this.Co.jt([r,t],function(t){e.Fo(t),i.push(t.key)}),i},Bh.prototype.$o=function(){var e=this;this.vo.forEach(function(t){return e.Fo(t)})},Bh.prototype.Fo=function(t){this.vo=this.vo.delete(t),this.Co=this.Co.delete(t)},Bh.prototype.ko=function(t){var e=new hi(new si([])),n=new Rh(e,t),t=new Rh(e,t+1),r=Wi();return this.Co.jt([n,t],function(t){r=r.add(t.key)}),r},Bh.prototype.Mo=function(t){var e=new Rh(t,0),e=this.vo.Gt(e);return null!==e&&t.isEqual(e.key)},Bh),Rh=(zh.bo=function(t,e){return hi.k(t.key,e.key)||ti(t.Uo,e.Uo)},zh.So=function(t,e){return ti(t.Uo,e.Uo)||hi.k(t.key,e.key)},zh),Dh=(Gh.prototype.qo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Gh.prototype.Bo=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Gh.prototype.Qo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Gh),Sh=(Fh.prototype.Go=function(t){},Fh.prototype.Ko=function(t,e,n){},Fh.prototype.zo=function(t){return this.jo.qo(t),this.Wo[t]||"not-current"},Fh.prototype.Ho=function(t,e,n){this.Wo[t]=e},Fh.prototype.Yo=function(t){this.jo.Bo(t)},Fh.prototype.Jo=function(t){return this.jo.activeTargetIds.has(t)},Fh.prototype.Xo=function(t){delete this.Wo[t]},Fh.prototype.Zo=function(){return this.jo.activeTargetIds},Fh.prototype.tu=function(t){return this.jo.activeTargetIds.has(t)},Fh.prototype.start=function(){return this.jo=new Dh,Promise.resolve()},Fh.prototype.nu=function(t,e,n){},Fh.prototype.eu=function(t){},Fh.prototype.su=function(){},Fh.prototype.ws=function(t){},Fh.prototype.iu=function(){},Fh),Lh=function(t){this.key=t},Ph=function(t){this.key=t},Vh=(Object.defineProperty(qh.prototype,"au",{get:function(){return this.ru},enumerable:!1,configurable:!0}),qh.prototype.lu=function(t,e){var s=this,u=e?e._u:new Qi,a=(e||this).hu,h=(e||this).nn,c=a,l=!1,f=pu(this.query)&&a.size===this.query.limit?a.last():null,p=du(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof ou?e:null)&&(Nu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.he||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.fu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.cu(r,f)||p&&s.cu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),pu(this.query)||du(this.query))for(;c.size>this.query.limit;){var n=pu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{hu:c,_u:u,_i:l,nn:h}},qh.prototype.fu=function(t,e){return t.he&&e.hasCommittedMutations&&!e.he},qh.prototype.du=function(t,e,n){var o=this,r=this.hu;this.hu=t.hu,this.nn=t.nn;var i=t._u.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jr()}}var r,i}),this.wu(n);var s=e?this.Eu():[],n=0===this.uu.size&&this._n?1:0,e=n!==this.ou;return this.ou=n,0!==i.length||e?{snapshot:new Ki(this.query,t.hu,r,i,t.nn,0==n,e,!1),mu:s}:{mu:s}},qh.prototype.Eo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.du({hu:this.hu,_u:new Qi,nn:this.nn,_i:!1},!1)):{mu:[]}},qh.prototype.Tu=function(t){return!this.ru.has(t)&&!!this.hu.has(t)&&!this.hu.get(t).he},qh.prototype.wu=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.ru=e.ru.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.ru=e.ru.delete(t)}),this._n=t._n)},qh.prototype.Eu=function(){var e=this;if(!this._n)return[];var n=this.uu;this.uu=Wi(),this.hu.forEach(function(t){e.Tu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new Ph(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new Lh(t))}),r},qh.prototype.Au=function(t){this.ru=t.nr,this.uu=Wi();t=this.lu(t.documents);return this.du(t,!0)},qh.prototype.Iu=function(){return Ki.rn(this.query,this.hu,this.nn,0===this.ou)},qh),Uh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},jh=function(t){this.key=t,this.Ru=!1},Mh=(Object.defineProperty(xh.prototype,"$u",{get:function(){return!0===this.Lu},enumerable:!1,configurable:!0}),xh);function xh(t,e,n,r,i,o){this.zr=t,this.Pu=e,this.yu=n,this.Vu=r,this.currentUser=i,this.pu=o,this.gu={},this.vu=new ia(Tu,Eu),this.bu=new Map,this.Cu=[],this.Su=new Di(hi.k),this.Du=new Map,this.Nu=new kh,this.xu={},this.Fu=new Map,this.Ou=La.Ti(),this.onlineState="Unknown",this.Lu=void 0}function qh(t,e){this.query=t,this.ru=e,this.ou=null,this._n=!1,this.uu=Wi(),this.nn=Wi(),this.cu=Au(t),this.hu=new Xi(this.cu)}function Fh(){this.jo=new Dh,this.Wo={},this.Mr=null,this._s=null}function Gh(){this.activeTargetIds=Yi}function zh(t,e){this.key=t,this.Uo=e}function Bh(){this.vo=new Mi(Rh.bo),this.Co=new Mi(Rh.So)}function Hh(t,e,n){this.query=t,this.Ao=e,this.Io=!1,this.Ro=null,this.onlineState="Unknown",this.options=n||{}}function Wh(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Pu.Yr.uo=Xh.bind(null,e),e.Pu.Yr.Zn=function(t,e){var n=t,t=n.Du.get(e);if(t&&t.Ru)return Wi().add(t.key);var r=Wi(),e=n.bu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.vu.get(s);r=r.Kt(s.view.au)}return r}.bind(null,e),e.Pu.Yr.oo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vu.Ho(s,"rejected",u),i=e.Du.get(s),(n=i&&i.key)?(r=(r=new Di(hi.k)).Tt(n,new su(n,oi.min())),i=Wi().add(n),i=new Ji(oi.min(),new Map,new Mi(ti),r,i),[4,Xh(e,i)]):[3,2];case 1:return t.sent(),e.Su=e.Su.remove(n),e.Du.delete(s),nc(e),[3,4];case 2:return[4,za(e.zr,s,!1).then(function(){return Zh(e,s,u)}).catch(Ha)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.gu.pr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].mo(s)&&(r=!0);u._o=s}}r&&Oh(n)}.bind(null,e.yu),e.gu.ku=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.yu),(a=(n=e).vu.get(c))?(o=a.targetId,n.Vu.zo(o),s=a.view.Iu(),[3,4]):[3,1];case 1:return[4,(e=n.zr,r=wu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.gi.Zi(e,r).next(function(t){return t?(n=t,oa.resolve(n)):i.gi.Mu(e).next(function(t){return n=new Oi(r,t,0,e.Gi),i.gi.Uu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ii.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Ii=i.Ii.Tt(t.targetId,t),i.Ri.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Vu.zo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.qu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.lu(o))._i?[4,Ba(r.zr,i.query,!1).then(function(t){t=t.documents;return i.view.lu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.du(e,r.$u,n),[2,(ec(r,i.targetId,n.mu),n.snapshot)]}})})}(i,t,e,n)},[4,Ba(i.zr,o,!0)];case 1:return n=t.sent(),r=new Vh(o,n.nr),e=r.lu(n.documents),n=$i.ln(s,u&&"Offline"!==i.onlineState),n=r.du(e,i.$u,n),ec(i,s,n.mu),r=new Uh(o,s,r),i.vu.set(o,r),i.bu.has(s)?i.bu.get(s).push(o):i.bu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.$u&&uh(n.Pu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function Yh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Pu.Yr.co=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,qa(e.zr,o)];case 2:return r=t.sent(),$h(e,n,null),Jh(e,n),e.Vu.Ko(n,"acknowledged"),[4,rc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ha(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Pu.Yr.ho=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.zr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.ju(e,r).next(function(t){return Mr(null!==t),n=t.keys(),i.je.qi(e,t)}).next(function(){return i.je.Bi(e)}).next(function(){return i.bi.Je(e,n)})}))];case 2:return o=t.sent(),$h(n,u,a),Jh(n,u),n.Vu.Ko(u,"rejected",a),[4,rc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ha(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.zr,a=p,c=r,l=ii.now(),i=a.reduce(function(t,e){return t.add(e.key)},Wi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.bi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof zs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ou?t.field(i.field):void 0,o=us(i.transform,o||null);null!=o&&(e=(null==e?new Js:e).set(i.field,o))}return e?e.ae():null}(o):null);null!=o&&e.push(new Ms(i.key,o,function s(t){var u=[];return yo(t.fields||{},function(t,e){var n=new ai([t]);if(Po(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new As(u)}(o.proto.mapValue),_s.exists(!0)))}return c.je.Bu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Qu:e}}))];case 2:return s=t.sent(),u.Vu.Go(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.xu[e.currentUser.h()])||new Di(ti)).Tt(n,o),e.xu[e.currentUser.h()]=r,[4,rc(u,s.Qu)];case 3:return t.sent(),[4,mh(u.Pu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Oa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Xh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ga(n.zr,i)];case 2:return e=t.sent(),i.on.forEach(function(t,e){e=n.Du.get(e);e&&(Mr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Ru=!0:0<t.dn.size?Mr(e.Ru):0<t.wn.size&&(Mr(e.Ru),e.Ru=!1))}),[4,rc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ha(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Qh(t,n,e){var r,t=t;(t.$u&&0===e||!t.$u&&1===e)&&(r=[],t.vu.forEach(function(t,e){e=e.view.Eo(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Eo(i)&&(o=!0)}),o&&Oh(t)}(t.yu,n),r.length&&t.gu.pr(r),t.onlineState=n,t.$u&&t.Vu.eu(n))}function Kh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:ph((n=o).Pu)||Lr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.zr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Wu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fu.get(r)||[]).push(s),n.Fu.set(r,i),[3,4]);case 3:return i=t.sent(),i=Oa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Jh(t,e){(t.Fu.get(e)||[]).forEach(function(t){t.resolve()}),t.Fu.delete(e)}function $h(t,e,n){var r=t,i=r.xu[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xu[r.currentUser.h()]=i)}function Zh(e,t,n){void 0===n&&(n=null),e.Vu.Yo(t);for(var r=0,i=e.bu.get(t);r<i.length;r++){var o=i[r];e.vu.delete(o),n&&e.gu.ku(o,n)}e.bu.delete(t),e.$u&&e.Nu.Lo(t).forEach(function(t){e.Nu.Mo(t)||tc(e,t)})}function tc(t,e){var n=t.Su.get(e);null!==n&&(ah(t.Pu,n),t.Su=t.Su.remove(e),t.Du.delete(n),nc(t))}function ec(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Lh?(t.Nu.Do(o.key,e),function(t,e){e=e.key;t.Su.get(e)||(Lr("SyncEngine","New document in limbo: "+e),t.Cu.push(e),nc(t))}(t,o)):o instanceof Ph?(Lr("SyncEngine","Document no longer in limbo: "+o.key),t.Nu.xo(o.key,e),t.Nu.Mo(o.key)||tc(t,o.key)):jr()}}function nc(t){for(;0<t.Cu.length&&t.Su.size<t.pu;){var e=t.Cu.shift(),n=t.Ou.next();t.Du.set(n,new jh(e)),t.Su=t.Su.Tt(e,n),uh(t.Pu,new Oi(wu(fu(e.path)),n,2,ya.Es))}}function rc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).vu.W()?[3,3]:(n.vu.forEach(function(t,e){o.push(n.qu(e,s,u).then(function(t){t&&(n.$u&&n.Vu.Ho(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=da.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.gu.pr(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return oa.forEach(h,function(e){return oa.forEach(e.cs,function(t){return r.persistence.Hi.Do(n,e.targetId,t)}).next(function(){return oa.forEach(e.hs,function(t){return r.persistence.Hi.xo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ea(e=t.sent()))throw e;return Lr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ii.get(o),u=s.ft,u=s.Et(u),r.Ii=r.Ii.Tt(o,u));return[2]}})})}(n.zr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function ic(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Lr("SyncEngine","User change. New user:",o.h()),[4,xa(n.zr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fu.forEach(function(t){t.forEach(function(t){t.reject(new Gr(Fr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fu.clear(),n.Vu.nu(o,r.Li,r.$i),[4,rc(n,r.Oi)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var oc,sc,uc,ac=(Fc.prototype.zu=function(t){return oa.resolve(0===this.je.length)},Fc.prototype.Bu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1];n=new na(i,e,n,r);this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new Rh(u.key,i)),this.We.wi(t,u.key.path.q())}return oa.resolve(n)},Fc.prototype.ju=function(t,e){return oa.resolve(this.Hu(e))},Fc.prototype.Xi=function(t,e){e+=1,e=this.Yu(e),e=e<0?0:e;return oa.resolve(this.je.length>e?this.je[e]:null)},Fc.prototype.Wu=function(){return oa.resolve(0===this.je.length?-1:this.Gu-1)},Fc.prototype.Fi=function(t){return oa.resolve(this.je.slice())},Fc.prototype.Ke=function(t,e){var n=this,r=new Rh(e,0),e=new Rh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.Uo);i.push(t)}),oa.resolve(i)},Fc.prototype.Ze=function(t,e){var n=this,r=new Mi(ti);return e.forEach(function(t){var e=new Rh(t,0),t=new Rh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.Uo)})}),oa.resolve(this.Ju(r))},Fc.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;hi.ot(e)||(e=e.child(""));var e=new Rh(new hi(e),0),i=new Mi(ti);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.Uo)),!0)},e),oa.resolve(this.Ju(i))},Fc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Hu(t);null!==t&&n.push(t)}),n},Fc.prototype.qi=function(n,r){var i=this;Mr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return oa.forEach(r.mutations,function(t){var e=new Rh(t.key,r.batchId);return o=o.delete(e),i.Hi.Zu(n,t.key)}).next(function(){i.Ku=o})},Fc.prototype.tc=function(t){},Fc.prototype.Mo=function(t,e){var n=new Rh(e,0),n=this.Ku.Gt(n);return oa.resolve(e.isEqual(n&&n.key))},Fc.prototype.Bi=function(t){return this.je.length,oa.resolve()},Fc.prototype.Xu=function(t,e){return this.Yu(t)},Fc.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Fc.prototype.Hu=function(t){t=this.Yu(t);return t<0||t>=this.je.length?null:this.je[t]},Fc),hc=(qc.prototype.Ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:i,readTime:n}),this.size+=i-o,this.We.wi(t,r.path.q())},qc.prototype.Yi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},qc.prototype.He=function(t,e){e=this.docs.get(e);return oa.resolve(e?e.ec:null)},qc.prototype.getEntries=function(t,e){var n=this,r=qi;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),oa.resolve(r)},qc.prototype.ts=function(t,e,n){for(var r=zi,i=new hi(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=o.Dt(),u=s.key,a=s.value,s=a.ec,a=a.readTime;if(!e.path.G(u.path))break;a.F(n)<=0||s instanceof ou&&Nu(e,s)&&(r=r.Tt(s.key,s))}return oa.resolve(r)},qc.prototype.sc=function(t,e){return oa.forEach(this.docs,function(t){return e(t)})},qc.prototype.ki=function(t){return new cc(this)},qc.prototype.ic=function(t){return oa.resolve(this.size)},qc),cc=(xc.prototype.oc=function(t){t=this.Qu.get(t);return t?t.readTime:oi.min()},xc.prototype.Ui=function(t,e){this.uc(),this.Qu.set(t.key,{ec:t,readTime:e})},xc.prototype.Yi=function(t,e){void 0===e&&(e=null),this.uc(),this.Qu.set(t,{ec:null,readTime:e})},xc.prototype.He=function(t,e){this.uc();var n=this.Qu.get(e);return void 0!==n?oa.resolve(n.ec):this.cc(t,e)},xc.prototype.getEntries=function(t,e){return this.hc(t,e)},xc.prototype.apply=function(t){return this.uc(),this.rc=!0,this.du(t)},xc.prototype.uc=function(){},n(Mc,uc=xc),Mc.prototype.du=function(n){var r=this,i=[];return this.Qu.forEach(function(t,e){e&&e.ec?i.push(r.ac.Ui(n,e.ec,r.oc(t))):r.ac.Yi(t)}),oa.qe(i)},Mc.prototype.cc=function(t,e){return this.ac.He(t,e)},Mc.prototype.hc=function(t,e){return this.ac.getEntries(t,e)},Mc),lc=(jc.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),oa.resolve()},jc.prototype.Qi=function(t){return oa.resolve(this.lastRemoteSnapshotVersion)},jc.prototype.wc=function(t){return oa.resolve(this._c)},jc.prototype.Mu=function(t){return this.highestTargetId=this.dc.next(),oa.resolve(this.highestTargetId)},jc.prototype.Ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),oa.resolve()},jc.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new La(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},jc.prototype.Uu=function(t,e){return this.Ec(e),this.targetCount+=1,oa.resolve()},jc.prototype.Ki=function(t,e){return this.Ec(e),oa.resolve()},jc.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.Lo(e.targetId),--this.targetCount,oa.resolve()},jc.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),oa.qe(u).next(function(){return s})},jc.prototype.Ic=function(t){return oa.resolve(this.targetCount)},jc.prototype.Zi=function(t,e){e=this.lc.get(e)||null;return oa.resolve(e)},jc.prototype.Wi=function(t,e,n){return this.fc.No(e,n),oa.resolve()},jc.prototype.ji=function(e,t,n){this.fc.Oo(t,n);var r=this.persistence.Hi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),oa.qe(i)},jc.prototype.Ac=function(t,e){return this.fc.Lo(e),oa.resolve()},jc.prototype.tr=function(t,e){e=this.fc.ko(e);return oa.resolve(e)},jc.prototype.Mo=function(t,e){return oa.resolve(this.fc.Mo(e))},jc),fc=(Uc.prototype.yc=function(t,e){return oa.resolve(this.Rc.get(e))},Uc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:zo(e.createTime)}),oa.resolve()},Uc.prototype.gc=function(t,e){return oa.resolve(this.Pc.get(e))},Uc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(r=n.bundledQuery,e=ts({parent:r.parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?bu(e,e.limit,"L"):e),readTime:zo(n.readTime)}),oa.resolve()},Uc),pc=(Vc.prototype.start=function(){return Promise.resolve()},Vc.prototype.su=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(Vc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),Vc.prototype.xc=function(){},Vc.prototype.Fc=function(){},Vc.prototype.Ci=function(){return this.We},Vc.prototype.yi=function(t){var e=this.bc[t.h()];return e||(e=new ac(this.We,this.Hi),this.bc[t.h()]=e),e},Vc.prototype.vi=function(){return this.gi},Vc.prototype.pi=function(){return this.Qe},Vc.prototype.Di=function(){return this.Si},Vc.prototype.runTransaction=function(t,e,n){var r=this;Lr("MemoryPersistence","Starting transaction:",t);var i=new dc(this.Cc.next());return this.Hi.Oc(),n(i).next(function(t){return r.Hi.Lc(i).next(function(){return t})}).Me().then(function(t){return i.$c(),t})},Vc.prototype.kc=function(e,n){return oa.Be(Object.values(this.bc).map(function(t){return function(){return t.Mo(e,n)}}))},Vc),dc=(Pc.prototype.Uc=function(t){this.Mc.push(t)},Pc.prototype.$c=function(){this.Mc.forEach(function(t){return t()})},n(Lc,sc=Pc),Lc),yc=(Sc.Qc=function(t){return new Sc(t)},Object.defineProperty(Sc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw jr()},enumerable:!1,configurable:!0}),Sc.prototype.Do=function(t,e,n){return this.qc.Do(n,e),this.jc.delete(n.toString()),oa.resolve()},Sc.prototype.xo=function(t,e,n){return this.qc.xo(n,e),this.jc.add(n.toString()),oa.resolve()},Sc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),oa.resolve()},Sc.prototype.removeTarget=function(t,e){var n=this;this.qc.Lo(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.vi();return r.tr(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},Sc.prototype.Oc=function(){this.Bc=new Set},Sc.prototype.Lc=function(n){var r=this,i=this.persistence.pi().ki();return oa.forEach(this.jc,function(t){var e=hi.st(t);return r.Wc(n,e).next(function(t){t||i.Yi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},Sc.prototype.zi=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},Sc.prototype.Dc=function(t){return 0},Sc.prototype.Wc=function(t,e){var n=this;return oa.Be([function(){return oa.resolve(n.qc.Mo(e))},function(){return n.persistence.vi().Mo(t,e)},function(){return n.persistence.kc(t,e)}])},Sc),vc=(Dc.prototype.yr=function(t){this.zc=t},Dc.prototype.Tr=function(t){this.Hc=t},Dc.prototype.onMessage=function(t){this.Yc=t},Dc.prototype.close=function(){this.Kc()},Dc.prototype.send=function(t){this.Gc(t)},Dc.prototype.Jc=function(){this.zc()},Dc.prototype.Xc=function(t){this.Hc(t)},Dc.prototype.Zc=function(t){this.Yc(t)},Dc),gc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},mc=(Rc.prototype.$r=function(e,t,n,r){var i=this.sh(e,t);Lr("RestConnection","Sending: ",i,n);t={};return this.ih(t,r),this.rh(e,i,t,n).then(function(t){return Lr("RestConnection","Received: ",t),t},function(t){throw Vr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Rc.prototype.kr=function(t,e,n,r){return this.$r(t,e,n,r)},Rc.prototype.ih=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.2",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},Rc.prototype.sh=function(t,e){t=gc[t];return this.nh+"/v1/"+e+":"+t},n(kc,oc=Rc),kc.prototype.rh=function(o,e,s,u){return new Promise(function(n,r){var i=new Ir;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Lr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Lr("Connection",'RPC "'+o+'" timed out'),r(new Gr(Fr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Lr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Fr).indexOf(e)?e:Fr.UNKNOWN,r(new Gr(e,t.message))):r(new Gr(Fr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Gr(Fr.UNAVAILABLE,"Connection failed."));break;default:jr()}}finally{Lr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},kc.prototype.Vr=function(t,e){var n,r=[this.nh,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ih(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Lr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,h=new vc({Gc:function(t){a?Lr("Connection","Not sending because WebChannel is closed:",t):(u||(Lr("Connection","Opening WebChannel transport."),s.open(),u=!0),Lr("Connection","WebChannel sending:",t),s.send(t))},Kc:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Tr.EventType.OPEN,function(){a||Lr("Connection","WebChannel transport opened.")}),t(s,Tr.EventType.CLOSE,function(){a||(a=!0,Lr("Connection","WebChannel transport closed"),h.Xc())}),t(s,Tr.EventType.ERROR,function(t){a||(a=!0,Vr("Connection","WebChannel transport errored:",t),h.Xc(new Gr(Fr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Tr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Mr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Lr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ci[r];if(void 0!==t)return Ri(t)}(),i=n.message,void 0===t&&(t=Fr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.Xc(new Gr(t,i)),s.close()):(Lr("Connection","WebChannel received:",e),h.Zc(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Lr("Connection","Detected buffering proxy"):t.stat===Er&&Lr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Jc()},0),h},kc),wc=(_c.prototype.so=function(t){this.lh.push(t)},_c.prototype.su=function(){window.removeEventListener("online",this.oh),window.removeEventListener("offline",this.hh)},_c.prototype._h=function(){window.addEventListener("online",this.oh),window.addEventListener("offline",this.hh)},_c.prototype.uh=function(){Lr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lh;t<e.length;t++)(0,e[t])(0)},_c.prototype.ah=function(){Lr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lh;t<e.length;t++)(0,e[t])(1)},_c.fh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},_c),bc=(Oc.prototype.so=function(t){},Oc.prototype.su=function(){},Oc),Ec=(Cc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=la(e.th.t),this.Vu=this.dh(e),this.persistence=this.wh(e),[4,this.persistence.start()];case 1:return t.sent(),this.Eh=this.mh(e),this.zr=this.Th(e),[2]}})})},Cc.prototype.mh=function(t){return null},Cc.prototype.Th=function(t){return e=this.persistence,n=new ka,r=t.Ah,t=this.serializer,new Pa(e,n,r,t);var e,n,r},Cc.prototype.wh=function(t){return new pc(yc.Qc,this.serializer)},Cc.prototype.dh=function(t){return new Sh},Cc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Eh&&this.Eh.stop(),[4,this.Vu.su()];case 1:return t.sent(),[4,this.persistence.su()];case 2:return t.sent(),[2]}})})},Cc),Tc=(Ac.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.zr?[3,2]:(this.zr=n.zr,this.Vu=n.Vu,this.Hr=this.Ih(r),this.Pu=this.Rh(r),this.yu=this.Ph(r),this.yh=this.Vh(r,!n.synchronizeTabs),this.Vu.Mr=function(t){return Qh(e.yh,t,1)},this.Pu.Yr.ph=ic.bind(null,this.yh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Zr.delete(2),[4,oh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Zr.add(2),[4,sh(e)]);case 3:t.sent(),e.io.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.yh.$u)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ac.prototype.Ph=function(t){return new Ih},Ac.prototype.Ih=function(t){var e=la(t.th.t),n=(n=t.th,new mc(n));return t=t.credentials,new $a(t,n,e)},Ac.prototype.Rh=function(t){var e=this,n=this.zr,r=this.Hr,i=t.Ns,o=function(t){return Qh(e.yh,t,0)},t=new(wc.fh()?wc:bc);return new Wa(n,r,i,o,t)},Ac.prototype.Vh=function(t,e){return function(t,e,n,r,i,o,s){o=new Mh(t,e,n,r,i,o);return s&&(o.Lu=!0),o}(this.zr,this.Pu,this.yu,this.Vu,t.Ah,t.pu,e)},Ac.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Lr("RemoteStore","RemoteStore shutting down."),e.Zr.add(5),[4,sh(e)];case 1:return t.sent(),e.eo.su(),e.io.set("Unknown"),[2]}})})}(this.Pu)},Ac),Ic=(Nc.prototype.next=function(t){this.observer.next&&this.gh(this.observer.next,t)},Nc.prototype.error=function(t){this.observer.error?this.gh(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Nc.prototype.bh=function(){this.muted=!0},Nc.prototype.gh=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Nc);function Nc(t){this.observer=t,this.muted=!1}function Ac(){}function Cc(){this.synchronizeTabs=!1}function Oc(){}function _c(){var t=this;this.oh=function(){return t.uh()},this.hh=function(){return t.ah()},this.lh=[],this._h()}function kc(t){var e=this;return(e=oc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Rc(t){this.th=t,this.t=t.t;var e=t.ssl?"https":"http";this.nh=e+"://"+t.host,this.eh="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Dc(t){this.Gc=t.Gc,this.Kc=t.Kc}function Sc(t){this.persistence=t,this.qc=new kh,this.Bc=null}function Lc(t){var e=this;return(e=sc.call(this)||this).Gi=t,e}function Pc(){this.Mc=[]}function Vc(t,e){var n=this;this.bc={},this.Cc=new ya(0),this.Sc=!1,this.Sc=!0,this.Hi=t(this),this.gi=new lc(this),this.We=new Da,this.Qe=(t=this.We,new hc(t,function(t){return n.Hi.Dc(t)})),this.serializer=new _a(e),this.Si=new fc(this.serializer)}function Uc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function jc(t){this.persistence=t,this.lc=new ia(bi,Ei),this.lastRemoteSnapshotVersion=oi.min(),this.highestTargetId=0,this._c=0,this.fc=new kh,this.targetCount=0,this.dc=La.mi()}function Mc(t){var e=this;return(e=uc.call(this)||this).ac=t,e}function xc(){this.Qu=new ia(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function qc(t,e){this.We=t,this.nc=e,this.docs=new Di(hi.k),this.size=0}function Fc(t,e){this.We=t,this.Hi=e,this.je=[],this.Gu=1,this.Ku=new Mi(Rh.bo)}function Gc(t,e,n){if(!n)throw new Gr(Fr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function zc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Bc(t,e,n,r){if(!0===e&&!0===r)throw new Gr(Fr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Hc(t){if(!hi.ot(t))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Wc(t){if(hi.ot(t))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Yc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":jr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Xc(t,e){if("_delegate"in t&&(t=t.Ch),t instanceof e)return t;if(e.name===t.constructor.name)throw new Gr(Fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Yc(t);throw new Gr(Fr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Qc(t,e){if(e<=0)throw new Gr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Kc,Jc=function(t){this._methodName=t},$c=(n(Zc,Kc=Jc),Zc.prototype.Sh=function(t){if(2!==t.Dh)throw 1===t.Dh?t.Nh(this._methodName+"() can only appear at the top level of your update data"):t.Nh(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},Zc.prototype.isEqual=function(t){return t instanceof Zc},Zc);function Zc(){return null!==Kc&&Kc.apply(this,arguments)||this}function tl(t,e,n){return new Xf({Dh:3,xh:e.settings.xh,methodName:t._methodName,Fh:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var el,nl,rl,il,ol=(n(Tl,il=Jc),Tl.prototype.Sh=function(t){return new Ns(t.path,new cs)},Tl.prototype.isEqual=function(t){return t instanceof Tl},Tl),sl=(n(El,rl=Jc),El.prototype.Sh=function(t){var e=tl(this,t,!0),n=this.Oh.map(function(t){return np(t,e)}),n=new ls(n);return new Ns(t.path,n)},El.prototype.isEqual=function(t){return this===t},El),ul=(n(bl,nl=Jc),bl.prototype.Sh=function(t){var e=tl(this,t,!0),n=this.Oh.map(function(t){return np(t,e)}),n=new vs(n);return new Ns(t.path,n)},bl.prototype.isEqual=function(t){return this===t},bl),al=(n(wl,el=Jc),wl.prototype.Sh=function(t){var e=new bs(t.serializer,qo(t.serializer,this.Lh));return new Ns(t.path,e)},wl.prototype.isEqual=function(t){return this===t},wl),hl=(Object.defineProperty(ml.prototype,"latitude",{get:function(){return this.$h},enumerable:!1,configurable:!0}),Object.defineProperty(ml.prototype,"longitude",{get:function(){return this.kh},enumerable:!1,configurable:!0}),ml.prototype.isEqual=function(t){return this.$h===t.$h&&this.kh===t.kh},ml.prototype.toJSON=function(){return{latitude:this.$h,longitude:this.kh}},ml.prototype.D=function(t){return ti(this.$h,t.$h)||ti(this.kh,t.kh)},ml),cl=(gl.fromBase64String=function(t){try{return new gl(Ii.fromBase64String(t))}catch(t){throw new Gr(Fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},gl.fromUint8Array=function(t){return new gl(Ii.fromUint8Array(t))},gl.prototype.toBase64=function(){return this.Mh.toBase64()},gl.prototype.toUint8Array=function(){return this.Mh.toUint8Array()},gl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},gl.prototype.isEqual=function(t){return this.Mh.isEqual(t.Mh)},gl),ll=function(t){this.Ch=t},fl=new Map,pl=(vl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},vl),dl=(Object.defineProperty(yl.prototype,"app",{get:function(){if(!this.Wh)throw new Gr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Wh},enumerable:!1,configurable:!0}),Object.defineProperty(yl.prototype,"Gh",{get:function(){return this.Bh},enumerable:!1,configurable:!0}),Object.defineProperty(yl.prototype,"Kh",{get:function(){return void 0!==this.zh},enumerable:!1,configurable:!0}),yl.prototype.Hh=function(t){if(this.Bh)throw new Gr(Fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.qh=new pl(t),void 0!==t.credentials&&(this.jh=function(t){if(!t)return new zr;switch(t.type){case"gapi":var e=t.client;return Mr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Wr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Gr(Fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},yl.prototype.Yh=function(){return this.qh},yl.prototype.Jh=function(){return this.Bh=!0,this.qh},yl.prototype._delete=function(){return this.zh||(this.zh=this.Xh()),this.zh},yl.prototype.Xh=function(){return t=this,(e=fl.get(t))&&(Lr("ComponentProvider","Removing Datastore"),fl.delete(t),e.terminate()),Promise.resolve();var t,e},yl);function yl(t,e){this.Uh="(lite)",this.qh=new pl({}),this.Bh=!1,t instanceof Or?(this.Qh=t,this.jh=new zr):(this.Wh=t,this.Qh=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Gr(Fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Or(t.options.projectId)}(t),this.jh=new Br(e))}function vl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(Fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Gr(Fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Bc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function gl(t){this.Mh=t}function ml(t,e){if(!isFinite(t)||t<-90||90<t)throw new Gr(Fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Gr(Fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.$h=t,this.kh=e}function wl(t,e){var n=this;return(n=el.call(this,t)||this).Lh=e,n}function bl(t,e){var n=this;return(n=nl.call(this,t)||this).Oh=e,n}function El(t,e){var n=this;return(n=rl.call(this,t)||this).Oh=e,n}function Tl(){return null!==il&&il.apply(this,arguments)||this}function Il(){if("undefined"==typeof Uint8Array)throw new Gr(Fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Nl(){if("undefined"==typeof atob)throw new Gr(Fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Al,Cl,Ol,_l=(n(Ul,Ol=ll),Ul.fromBase64String=function(t){return Nl(),new Ul(cl.fromBase64String(t))},Ul.fromUint8Array=function(t){return Il(),new Ul(cl.fromUint8Array(t))},Ul.prototype.toBase64=function(){return Nl(),this.Ch.toBase64()},Ul.prototype.toUint8Array=function(){return Il(),this.Ch.toUint8Array()},Ul.prototype.isEqual=function(t){return this.Ch.isEqual(t.Ch)},Ul.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ul),Ie=(Vl.prototype.Zh=function(t,e){switch(void 0===e&&(e="none"),bo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Oo(t.integerValue||t.doubleValue);case 3:return this.ta(t.timestampValue);case 4:return this.na(t,e);case 5:return t.stringValue;case 6:return this.ea(_o(t.bytesValue));case 7:return this.sa(t.referenceValue);case 8:return this.ia(t.geoPointValue);case 9:return this.ra(t.arrayValue,e);case 10:return this.oa(t.mapValue,e);default:throw jr()}},Vl.prototype.oa=function(t,n){var r=this,i={};return yo(t.fields||{},function(t,e){i[t]=r.Zh(e,n)}),i},Vl.prototype.ia=function(t){return new hl(Oo(t.latitude),Oo(t.longitude))},Vl.prototype.ra=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Zh(t,e)})},Vl.prototype.na=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return go(e)?t(e):e}(t);return null==n?null:this.Zh(n,e);case"estimate":return this.ta(mo(t));default:return null}},Vl.prototype.ta=function(t){t=Co(t);return new ii(t.seconds,t.nanos)},Vl.prototype.ua=function(t,e){var n=si.J(t);Mr(ss(n));t=new Or(n.get(1),n.get(3)),n=new hi(n.U(5));return t.isEqual(e)||Pr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Vl),kl=(n(Pl,Cl=Ie),Pl.prototype.ea=function(t){return new _l(new cl(t))},Pl.prototype.sa=function(t){t=this.ua(t,this.firestore.Qh);return Wp.ca(t,this.firestore,null)},Pl),Rl=(Object.defineProperty(Ll.prototype,"id",{get:function(){return this.la.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"ref",{get:function(){return new sf(this.ha,this.fa,this.la)},enumerable:!1,configurable:!0}),Ll.prototype.exists=function(){return null!==this._a},Ll.prototype.data=function(){if(this._a){if(this.fa){var t=new Dl(this.ha,this.aa,this.la,this._a,null);return this.fa.fromFirestore(t)}return this.aa.Zh(this._a.Ee())}},Ll.prototype.get=function(t){if(this._a){t=this._a.data().field(jl("DocumentSnapshot.get",t));if(null!==t)return this.aa.Zh(t)}},Ll),Dl=(n(Sl,Al=Rl),Sl.prototype.data=function(){return Al.prototype.data.call(this)},Sl);function Sl(){return null!==Al&&Al.apply(this,arguments)||this}function Ll(t,e,n,r,i){this.ha=t,this.aa=e,this.la=n,this._a=r,this.fa=i}function Pl(t){var e=this;return(e=Cl.call(this)||this).firestore=t,e}function Vl(){}function Ul(){return null!==Ol&&Ol.apply(this,arguments)||this}function jl(t,e){return"string"==typeof e?ap(t,e):(e instanceof ll?e.Ch:e).da}var Ml,xl=(Gl.prototype.isEqual=function(t){return this.da.isEqual(t.da)},Gl),ql=(n(Fl,Ml=dl),Fl.prototype.Xh=function(){return this.Ea||qp(this),this.Ea.terminate()},Fl);function Fl(t,e){var n=this;return(n=Ml.call(this,t,e)||this).wa=new Na,n.Uh="name"in t?t.name:"[DEFAULT]",n}function Gl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.da=new ai(t)}var zl,Bl,Hl=(n(Kl,Bl=Rl),Kl.prototype.exists=function(){return Bl.prototype.exists.call(this)},Kl.prototype.data=function(t){if(void 0===t&&(t={}),this._a){if(this.fa){var e=new Wl(this.ha,this.aa,this.la,this._a,this.metadata,null);return this.fa.fromFirestore(e,t)}return this.aa.Zh(this._a.Ee(),t.serverTimestamps)}},Kl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._a){t=this._a.data().field(jl("DocumentSnapshot.get",t));if(null!==t)return this.aa.Zh(t,e.serverTimestamps)}},Kl),Wl=(n(Ql,zl=Hl),Ql.prototype.data=function(t){return void 0===t&&(t={}),zl.prototype.data.call(this,t)},Ql),Yl=(Object.defineProperty(Xl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"size",{get:function(){return this.Ta.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Xl.prototype.forEach=function(e,n){var r=this;this.Ta.docs.forEach(function(t){e.call(n,new Wl(r.ha,r.aa,t.key,t,new od(r.Ta.nn.has(t.key),r.Ta.fromCache),r.query.fa))})},Xl.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Ta.sn)throw new Gr(Fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Aa&&this.Ia===t||(this.Aa=function(i,e){if(i.Ta.tn.W()){var n=0;return i.Ta.docChanges.map(function(t){var e=new Wl(i.ha,i.aa,t.doc.key,t.doc,new od(i.Ta.nn.has(t.doc.key),i.Ta.fromCache),i.query.fa);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Ta.tn;return i.Ta.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Wl(i.ha,i.aa,t.doc.key,t.doc,new od(i.Ta.nn.has(t.doc.key),i.Ta.fromCache),i.query.fa),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ia=t),this.Aa},Xl);function Xl(t,e,n,r){this.ha=t,this.aa=e,this.Ta=r,this.metadata=new od(r.hasPendingWrites,r.fromCache),this.query=n}function Ql(){return null!==zl&&zl.apply(this,arguments)||this}function Kl(t,e,n,r,i,o){var s=this;return(s=Bl.call(this,t,e,n,r,o)||this).ha=t,s.ma=t,s.metadata=i,s}function Jl(t,e){return t instanceof Hl&&e instanceof Hl?t.ha===e.ha&&t.la.isEqual(e.la)&&(null===t._a?null===e._a:t._a.isEqual(e._a))&&t.fa===e.fa:t instanceof Yl&&e instanceof Yl&&t.ha===e.ha&&qf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Ta.isEqual(e.Ta)}var $l,Zl=(n(tf,$l=Ie),tf.prototype.ea=function(t){return new cl(t)},tf.prototype.sa=function(t){t=this.ua(t,this.firestore.Qh);return new sf(this.firestore,null,t)},tf);function tf(t){var e=this;return(e=$l.call(this)||this).firestore=t,e}function ef(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Xc(t,sf);var o=Xc(t.firestore,ql),s=Ff(o);return e instanceof ll&&(e=e.Ch),rf(o,("string"==typeof e||e instanceof xl?tp(s,"updateDoc",t.la,e,n,r):Zf(s,"updateDoc",t.la,e)).Pa(t.la,_s.exists(!0)))}function nf(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof ll&&(e=e.Ch);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||fa(n[i])||(r=n[i],i++);var o,s,u,a,h,c,l={includeMetadataChanges:r.includeMetadataChanges};return fa(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof sf?(u=Xc(e.firestore,ql),a=fu(e.la.path),c={next:function(t){n[i]&&n[i](of(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Xc(e,uf),u=Xc(s.firestore,ql),a=s.Ra,h=new Zl(u),c={next:function(t){n[i]&&n[i](new Yl(u,h,s,t))},error:n[i+1],complete:n[i+2]},Rf(e.Ra)),function(n,t,e){var r=this,i=new Ic(c),o=new _h(t,i,e);return n.Ns.Ms(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ah,[4,Ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.bh(),n.Ns.Ms(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ch,[4,Ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(xp(u),a,l)}function rf(t,e){return function(n,r){var t=this,i=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Yh,[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(xp(t),e)}function of(t,e,n){var r=n.docs.get(e.la),i=new Zl(t);return new Hl(t,i,e.la,r,new od(n.hasPendingWrites,n.fromCache),e.fa)}var sf=(Object.defineProperty(hf.prototype,"ya",{get:function(){return this.la.path},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"id",{get:function(){return this.la.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"path",{get:function(){return this.la.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"parent",{get:function(){return new Sf(this.firestore,this.fa,this.la.path.q())},enumerable:!1,configurable:!0}),hf.prototype.withConverter=function(t){return new hf(this.firestore,t,this.la)},hf),uf=(af.prototype.withConverter=function(t){return new af(this.firestore,t,this.Ra)},af),l=function(){};function af(t,e,n){this.fa=e,this.Ra=n,this.type="query",this.firestore=t}function hf(t,e,n){this.fa=e,this.la=n,this.type="document",this.firestore=t}function cf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Va(t)}return t}var lf,ff,pf,df,yf,vf=(n(Af,yf=l),Af.prototype.Va=function(t){var e=Ff(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){_f(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(Of(n,t,h))}c={arrayValue:{values:s}}}else c=Of(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||_f(o,i),c=ep(e,"where",o,"in"===i||"not-in"===i);var c=Ou.create(r,i,c);return function(t,e){if(e.Ie()){var n=vu(t);if(null!==n&&!n.isEqual(e.field))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=yu(t);null!==n&&kf(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Ra,e,t.firestore.Qh,this.pa,this.ga,this.va);return new uf(t.firestore,t.fa,(t=t.Ra,e=t.filters.concat([e]),new au(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Af),gf=(n(Nf,df=l),Nf.prototype.Va=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ea(e,n);return e=r,null!==yu(n=t)||null!==(t=vu(n))&&kf(0,t,e.field),r}(t.Ra,this.pa,this.ba);return new uf(t.firestore,t.fa,(t=t.Ra,e=t.me.concat([e]),new au(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Nf),mf=(n(If,pf=l),If.prototype.Va=function(t){return new uf(t.firestore,t.fa,bu(t.Ra,this.Ca,this.Sa))},If),wf=(n(Tf,ff=l),Tf.prototype.Va=function(t){var e=Cf(t,this.type,this.Da,this.Na);return new uf(t.firestore,t.fa,(t=t.Ra,e=e,new au(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Tf),bf=(n(Ef,lf=l),Ef.prototype.Va=function(t){var e=Cf(t,this.type,this.Da,this.Na);return new uf(t.firestore,t.fa,(t=t.Ra,e=e,new au(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Ef);function Ef(t,e,n){var r=this;return(r=lf.call(this)||this).type=t,r.Da=e,r.Na=n,r}function Tf(t,e,n){var r=this;return(r=ff.call(this)||this).type=t,r.Da=e,r.Na=n,r}function If(t,e,n){var r=this;return(r=pf.call(this)||this).type=t,r.Ca=e,r.Sa=n,r}function Nf(t,e){var n=this;return(n=df.call(this)||this).pa=t,n.ba=e,n.type="orderBy",n}function Af(t,e,n){var r=this;return(r=yf.call(this)||this).pa=t,r.ga=e,r.va=n,r.type="where",r}function Cf(t,h,e,n){if(e[0]instanceof ll&&(e[0]=e[0].Ch),e[0]instanceof Rl)return function(t,e,n,r){if(!n)throw new Gr(Fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=mu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(ko(e,n.key));else{var a=n.field(u.field);if(go(a))throw new Gr(Fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.Y();throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Yu(i,r)}(t.Ra,t.firestore.Qh,e[0]._a,n);var r=Ff(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Gr(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!gu(t)&&-1!==h.indexOf("/"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(si.J(h));if(!hi.ot(c))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new hi(c);u.push(ko(e,c))}else{h=ep(n,r,h);u.push(h)}}return new Yu(u,o)}(t.Ra,t.firestore.Qh,r,h,e,n)}function Of(t,e,n){if(n instanceof ll&&(n=n.Ch),"string"==typeof n){if(""===n)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gu(e)&&-1!==n.indexOf("/"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(si.J(n));if(!hi.ot(e))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ko(t,new hi(e))}if(n instanceof sf)return ko(t,n.la);throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Yc(n)+".")}function _f(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function kf(t,e,n){if(!n.isEqual(e))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Rf(t){if(du(t)&&0===t.me.length)throw new Gr(Fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Df,Sf=(n(Lf,Df=uf),Object.defineProperty(Lf.prototype,"id",{get:function(){return this.Ra.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"path",{get:function(){return this.Ra.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"parent",{get:function(){var t=this.ya.q();return t.W()?null:new sf(this.firestore,null,new hi(t))},enumerable:!1,configurable:!0}),Lf.prototype.withConverter=function(t){return new Lf(this.firestore,t,this.ya)},Lf);function Lf(t,e,n){var r=this;return(r=Df.call(this,t,e,fu(n))||this).firestore=t,r.ya=n,r.type="collection",r}function Pf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t instanceof ll&&(t=t.Ch),Gc("collection","path",e),t instanceof dl){var i=si.J.apply(si,s([e],n));return Wc(i),new Sf(t,null,i)}if(!(t instanceof sf||t instanceof Sf))throw new Gr(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=si.J.apply(si,s([t.path],n)).child(si.J(e));return Wc(e),new Sf(t.firestore,null,e)}function Vf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t instanceof ll&&(t=t.Ch),1===arguments.length&&(e=$r.S()),Gc("doc","path",e),t instanceof dl){var i=si.J.apply(si,s([e],n));return Hc(i),new sf(t,null,new hi(i))}if(!(t instanceof sf||t instanceof Sf))throw new Gr(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.ya.child(si.J.apply(si,s([e],n)));return Hc(e),new sf(t.firestore,t instanceof Sf?t.fa:null,new hi(e))}var Uf,jf=(n(Mf,Uf=Ie),Mf.prototype.ea=function(t){return new cl(t)},Mf.prototype.sa=function(t){t=this.ua(t,this.firestore.Qh);return new sf(this.firestore,null,t)},Mf);function Mf(t){var e=this;return(e=Uf.call(this)||this).firestore=t,e}function xf(t,e){return t instanceof ll&&(t=t.Ch),e instanceof ll&&(e=e.Ch),(t instanceof sf||t instanceof Sf)&&(e instanceof sf||e instanceof Sf)&&t.firestore===e.firestore&&t.path===e.path&&t.fa===e.fa}function qf(t,e){return t instanceof ll&&(t=t.Ch),e instanceof ll&&(e=e.Ch),t instanceof uf&&e instanceof uf&&t.firestore===e.firestore&&Eu(t.Ra,e.Ra)&&t.fa===e.fa}function Ff(t){var e=t.Jh(),n=la(t.Qh);return new Qf(t.Qh,!!e.ignoreUndefinedProperties,n)}var Gf=/^__.*__$/,zf=(Wf.prototype.Pa=function(t,e){var n=[];return null!==this.ee?n.push(new Ms(t,this.data,this.ee,e)):n.push(new js(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new zs(t,this.fieldTransforms)),n},Wf),Bf=(Hf.prototype.Pa=function(t,e){e=[new Ms(t,this.data,this.ee,e)];return 0<this.fieldTransforms.length&&e.push(new zs(t,this.fieldTransforms)),e},Hf);function Hf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Wf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Yf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw jr()}}var Xf=(Object.defineProperty(Jf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Jf.prototype,"Dh",{get:function(){return this.settings.Dh},enumerable:!1,configurable:!0}),Jf.prototype.Fa=function(t){return new Jf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Jf.prototype.Oa=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Fa({path:e,Fh:!1});return e.La(t),e},Jf.prototype.$a=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Fa({path:t,Fh:!1});return t.xa(),t},Jf.prototype.ka=function(t){return this.Fa({path:void 0,Fh:!0})},Jf.prototype.Nh=function(t){return hp(t,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.xh)},Jf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Jf.prototype.xa=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.La(this.path.get(t))},Jf.prototype.La=function(t){if(0===t.length)throw this.Nh("Document fields must not be empty");if(Yf(this.Dh)&&Gf.test(t))throw this.Nh('Document fields cannot begin and end with "__"')},Jf),Qf=(Kf.prototype.Ua=function(t,e,n,r){return void 0===r&&(r=!1),new Xf({Dh:t,methodName:e,xh:n,path:ai.X(),Fh:!1,Ma:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Kf);function Kf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||la(t)}function Jf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.xa(),this.fieldTransforms=i||[],this.ee=o||[]}function $f(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Ua(o.merge||o.mergeFields?2:0,e,n,i);op("Data must be an object, but it was:",s,r);var u,a,r=rp(r,s);if(o.merge)u=new As(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=sp(e,l[c],n);if(!s.contains(f))throw new Gr(Fr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");cp(h,f)||h.push(f)}u=new As(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new zf(new Ks(r),u,a)}function Zf(t,r,i,e){var o=t.Ua(1,r,i);op("Data must be an object, but it was:",o,e);var s=[],u=new Js;yo(e,function(t,e){var n=ap(r,t,i);e instanceof ll&&(e=e.Ch);t=o.$a(n);e instanceof $c?s.push(n):null!=(t=np(e,t))&&(s.push(n),u.set(n,t))});e=new As(s);return new Bf(u.ae(),e,o.fieldTransforms)}function tp(t,e,n,r,i,o){var s=t.Ua(1,e,n),u=[sp(e,r,n)],a=[i];if(o.length%2!=0)throw new Gr(Fr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(sp(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Js,y=u.length-1;0<=y;--y){cp(p,u[y])||(c=u[y],(l=a[y])instanceof ll&&(l=l.Ch),f=s.$a(c),l instanceof $c?p.push(c):null!=(f=np(l,f))&&(p.push(c),d.set(c,f)))}i=new As(p);return new Bf(d.ae(),i,s.fieldTransforms)}function ep(t,e,n,r){return void 0===r&&(r=!1),np(n,t.Ua(r?4:3,e))}function np(s,t){if(s instanceof ll&&(s=s.Ch),ip(s))return op("Unsupported field value:",t,s),rp(s,t);if(s instanceof Jc)return function(t,e){if(!Yf(e.Dh))throw e.Nh(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Nh(t._methodName+"() is not currently supported inside arrays");t=t.Sh(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.Fh&&4!==t.Dh)throw t.Nh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=np(i[r],t.ka(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof ll&&(t=t.Ch),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return qo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ii.fromDate(t);return{timestampValue:Fo(e.serializer,n)}}if(t instanceof ii){var r=new ii(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Fo(e.serializer,r)}}if(t instanceof hl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof cl)return{bytesValue:Go(e.serializer,t.Mh)};if(t instanceof sf){n=e.t,r=t.firestore.Qh;if(!r.isEqual(n))throw e.Nh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Bo(t.firestore.Qh||e.t,t.la.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Nh("Unsupported field value: "+Yc(t))}(s,t)}function rp(t,n){var r={};return vo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):yo(t,function(t,e){e=np(e,n.Oa(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function ip(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ii||t instanceof hl||t instanceof cl||t instanceof sf||t instanceof Jc)}function op(t,e,n){if(!ip(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Yc(n);throw"an object"===n?e.Nh(t+" a custom object"):e.Nh(t+" "+n)}var r}function sp(t,e,n){if(e instanceof ll&&(e=e.Ch),e instanceof xl)return e.da;if("string"==typeof e)return ap(t,e);throw hp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var up=new RegExp("[~\\*/\\[\\]]");function ap(e,n,r){if(0<=n.search(up))throw hp("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(xl.bind.apply(xl,s([void 0],n.split("."))))).da}catch(t){throw hp("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function hp(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Gr(Fr.INVALID_ARGUMENT,(e+=". ")+t+n)}function cp(t,e){return t.some(function(t){return t.isEqual(e)})}var lp=(vp.prototype.Wa=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ga(),0<this.mutations.length)throw new Gr(Fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Qo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Wo(n.serializer,t)})},[4,n.kr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Mr(!!e.found),e.found.name,e.found.updateTime;var n=Yo(t,e.found.name),t=zo(e.found.updateTime),e=new Ks({mapValue:{fields:e.found.fields}});return new ou(n,t,e,{})}(e,t):"missing"in t?function(t,e){Mr(!!e.missing),Mr(!!e.readTime);t=Yo(t,e.missing),e=zo(e.readTime);return new su(t,e)}(e,t):jr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Mr(!!t),o.push(t)}),o)]}})})}(this.Hr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof su||t instanceof ou?n.Ka(t):jr()}),e)]}})})},vp.prototype.set=function(t,e){this.write(e.Pa(t,this.re(t))),this.ja.add(t.toString())},vp.prototype.update=function(t,e){try{this.write(e.Pa(t,this.za(t)))}catch(t){this.Qa=t}this.ja.add(t.toString())},vp.prototype.delete=function(t){this.write([new Xs(t,this.re(t))]),this.ja.add(t.toString())},vp.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ga(),this.Qa)throw this.Qa;return e=this.qa,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=hi.st(e);n.mutations.push(new Qs(e,n.re(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Qo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return $o(e.serializer,t)})},[4,e.$r("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Hr,this.mutations)];case 1:return t.sent(),this.Ba=!0,[2]}})})},vp.prototype.Ka=function(t){var e;if(t instanceof ou)e=t.version;else{if(!(t instanceof su))throw jr();e=oi.min()}var n=this.qa.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(Fr.ABORTED,"Document version changed between two reads.")}else this.qa.set(t.key.toString(),e)},vp.prototype.re=function(t){var e=this.qa.get(t.toString());return!this.ja.has(t.toString())&&e?_s.updateTime(e):_s.ce()},vp.prototype.za=function(t){var e=this.qa.get(t.toString());if(this.ja.has(t.toString())||!e)return _s.exists(!0);if(e.isEqual(oi.min()))throw new Gr(Fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},vp.prototype.write=function(t){this.Ga(),this.mutations=this.mutations.concat(t)},vp.prototype.Ga=function(){},vp),fp=(yp.prototype.run=function(){this.Ya()},yp.prototype.Ya=function(){var t=this;this.Ks.vs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new lp(this.Hr),(n=this.Ja(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Xa(t)})})}).catch(function(t){r.Xa(t)}),[2]})})})},yp.prototype.Ja=function(t){try{var e=this.updateFunction(t);return!vi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},yp.prototype.Xa=function(t){var e=this;0<this.Ha&&this.Za(t)?(--this.Ha,this.Ns.Ms(function(){return e.Ya(),Promise.resolve()})):this.Os.reject(t)},yp.prototype.Za=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!ki(t)},yp),pp=(dp.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,th:this.th,clientId:this.clientId,credentials:this.credentials,Ah:this.user,pu:100})]}})})},dp.prototype.nl=function(t){var e=this;this.tl=t,this.V.promise.then(function(){return e.tl(e.user)})},dp.prototype.el=function(){if(this.Ns.Hs)throw new Gr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},dp.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new sa;return this.Ns.Ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sl?[4,this.sl.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.il?[4,this.il.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Oa(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},dp);function dp(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.th=n,this.user=_r.UNAUTHENTICATED,this.clientId=$r.S(),this.tl=function(){},this.V=new sa,this.credentials.I(function(t){Lr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.tl(t)),r.V.resolve()})}function yp(t,e,n,r){this.Ns=t,this.Hr=e,this.updateFunction=n,this.Os=r,this.Ha=5,this.Ks=new wa(this.Ns,"transaction_retry")}function vp(t){this.Hr=t,this.qa=new Map,this.mutations=[],this.Ba=!1,this.Qa=null,this.ja=new Set}function gp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Lr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),Lr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.nl(function(e){return r.Ns.ti(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,xa(i.zr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.il=i,[2]}})})}(e,new Ec)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function mp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sl?[3,2]:(Lr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,gp(r)];case 1:return e=t.sent(),Lr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.nl(function(t){return r.Ns.ti(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Lr("RemoteStore","RemoteStore received new credentials"),n=ph(e),e.Zr.add(3),[4,sh(e)];case 1:return t.sent(),n&&e.io.set("Unknown"),[4,e.Yr.ph(i)];case 2:return t.sent(),e.Zr.delete(3),[4,oh(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)})}),r.sl=i,[2]}})})}(e,new Tc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sl]}})})}function wp(t){return gp(t).then(function(t){return t.persistence})}function bp(t){return gp(t).then(function(t){return t.zr})}function Ep(t){return mp(t).then(function(t){return t.Pu})}function Tp(t){return mp(t).then(function(t){return t.yh})}function Ip(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,mp(r)];case 1:return e=t.sent(),[2,((n=e.yu).wo=Wh.bind(null,e.yh),n.To=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vu.get(o),1<(r=e.bu.get(n.targetId)).length?[2,(e.bu.set(n.targetId,r.filter(function(t){return!Eu(t,o)})),void e.vu.delete(o))]:e.$u?(e.Vu.Yo(n.targetId),e.Vu.tu(n.targetId)?[3,2]:[4,za(e.zr,n.targetId,!1).then(function(){e.Vu.Xo(n.targetId),ah(e.Pu,n.targetId),Zh(e,n.targetId)}).catch(Ha)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Zh(e,n.targetId),[4,za(e.zr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.yh),n)]}})})}function Np(n,r,i){var t=this;void 0===i&&(i={});var o=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Ic({next:function(t){r.Ms(function(){return Ch(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Gr(Fr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Gr(Fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new _h(fu(i.path),t,{includeMetadataChanges:!0,po:!0});return Ah(n,u)},[4,Ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ns,r,i,o])]}})})}),o.promise}function Ap(n,r,i){var t=this;void 0===i&&(i={});var o=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Ic({next:function(t){n.Ms(function(){return Ch(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Gr(Fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new _h(t,o,{includeMetadataChanges:!0,po:!0});return Ah(e,s)},[4,Ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ns,r,i,o])]}})})}),o.promise}var Cp=(Op.prototype.set=function(t,e,n){this.hl();t=_p(t,this.ha),e=bd(t.fa,e,n),n=$f(this.cl,"WriteBatch.set",t.la,e,null!==t.fa,n);return this.ol=this.ol.concat(n.Pa(t.la,_s.ce())),this},Op.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.hl();t=_p(t,this.ha);return e instanceof ll&&(e=e.Ch),e="string"==typeof e||e instanceof xl?tp(this.cl,"WriteBatch.update",t.la,e,n,r):Zf(this.cl,"WriteBatch.update",t.la,e),this.ol=this.ol.concat(e.Pa(t.la,_s.exists(!0))),this},Op.prototype.delete=function(t){this.hl();t=_p(t,this.ha);return this.ol=this.ol.concat(new Xs(t.la,_s.ce())),this},Op.prototype.commit=function(){return this.hl(),this.ul=!0,0<this.ol.length?this.rl(this.ol):Promise.resolve()},Op.prototype.hl=function(){if(this.ul)throw new Gr(Fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Op);function Op(t,e){this.ha=t,this.rl=e,this.ol=[],this.ul=!1,this.cl=Ff(t)}function _p(t,e){if(t instanceof ll&&(t=t.Ch),t.firestore!==e)throw new Gr(Fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var kp,Rp,Dp=(Mp.prototype.get=function(t){var e=this,n=_p(t,this.ha),r=new jf(this.ha);return this.al.Wa([n.la]).then(function(t){if(!t||1!==t.length)return jr();t=t[0];if(t instanceof su)return new Rl(e.ha,r,n.la,null,n.fa);if(t instanceof ou)return new Rl(e.ha,r,t.key,t,n.fa);throw jr()})},Mp.prototype.set=function(t,e,n){t=_p(t,this.ha),e=bd(t.fa,e,n),n=$f(this.cl,"Transaction.set",t.la,e,null!==t.fa,n);return this.al.set(t.la,n),this},Mp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=_p(t,this.ha);return e instanceof ll&&(e=e.Ch),e="string"==typeof e||e instanceof xl?tp(this.cl,"Transaction.update",t.la,e,n,r):Zf(this.cl,"Transaction.update",t.la,e),this.al.update(t.la,e),this},Mp.prototype.delete=function(t){t=_p(t,this.ha);return this.al.delete(t.la),this},n(jp,Rp=Mp),jp.prototype.get=function(t){var e=this,n=_p(t,this.ha),r=new Zl(this.ha);return Rp.prototype.get.call(this,t).then(function(t){return new Hl(e.ha,r,n.la,t._a,new od(!1,!1),n.fa)})},jp),Sp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Lp=(Up.prototype.enableIndexedDbPersistence=function(t,e){throw new Gr(Fr.FAILED_PRECONDITION,Sp)},Up.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Gr(Fr.FAILED_PRECONDITION,Sp)},Up.prototype.clearIndexedDbPersistence=function(t){throw new Gr(Fr.FAILED_PRECONDITION,Sp)},Up),Pp=(n(Vp,kp=ll),Object.defineProperty(Vp.prototype,"Qh",{get:function(){return this.Ch.Qh},enumerable:!1,configurable:!0}),Vp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.Ch.Yh()),t)).merge,this.Ch.Hh(t)},Vp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.Ch.Yh().host&&Vr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Vp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return e=t.sent(),[4,Ep(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Zr.delete(0),oh(t))]}})})})}(xp(Xc(this.Ch,ql)))},Vp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return e=t.sent(),[4,Ep(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Zr.add(0),[4,sh(e)];case 1:return t.sent(),e.io.set("Offline"),[2]}})})}(n))]}})})})}(xp(Xc(this.Ch,ql)))},Vp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Bc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.ll.enableMultiTabIndexedDbPersistence(this):this.ll.enableIndexedDbPersistence(this,n)},Vp.prototype.clearPersistence=function(){return this.ll.clearIndexedDbPersistence(this)},Vp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.Ch._delete()},Vp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Kh,[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(xp(Xc(this.Ch,ql)))},Vp.prototype.onSnapshotsInSync=function(t){return e=this.Ch,t=t,function(n,t){var e=this,r=new Ic(t);return n.Ns.Ms(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.fo.add(e),e.next()},[4,Ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.bh(),n.Ns.Ms(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.fo.delete(e)},[4,Ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(xp(Xc(e,ql)),fa(t)?t:{next:t});var e},Object.defineProperty(Vp.prototype,"app",{get:function(){if(!this._l)throw new Gr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._l},enumerable:!1,configurable:!0}),Vp.prototype.collection=function(t){try{return new ld(this,Pf(this.Ch,t))}catch(t){throw Kp(t,"collection()","Firestore.collection()")}},Vp.prototype.doc=function(t){try{return new Wp(this,Vf(this.Ch,t))}catch(t){throw Kp(t,"doc()","Firestore.doc()")}},Vp.prototype.collectionGroup=function(t){try{return new ad(this,function(t,e){if(t=Xc(t,dl),Gc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new uf(t,null,(e=e,new au(si.X(),e)))}(this.Ch,t))}catch(t){throw Kp(t,"collectionGroup()","Firestore.collectionGroup()")}},Vp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,mp(n).then(function(t){return t.Hr})];case 1:return e=t.sent(),new fp(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(xp(n=this.Ch),function(t){return t=new Dp(n,t),e(new Bp(r,t))})},Vp.prototype.batch=function(){var e=this;return xp(this.Ch),new Hp(new Cp(this.Ch,function(t){return rf(e.Ch,t)}))},Vp);function Vp(t,e,n){var r=this;return(r=kp.call(this,e)||this).ll=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Or||(r._l=t),r}function Up(){}function jp(t,e){var n=this;return(n=Rp.call(this,t,e)||this).ha=t,n}function Mp(t,e){this.ha=t,this.al=e,this.cl=Ff(t)}function xp(t){return t.Ea||qp(t),t.Ea.el(),t.Ea}function qp(t){var e,n,r=t.Jh(),r=(e=t.Qh,n=t.Uh,new Cr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ea=new pp(t.jh,t.wa,r)}var Fp,Gp,zp,Bp=(n(Qp,zp=ll),Qp.prototype.get=function(t){var e=this,t=wd(t);return this.Ch.get(t).then(function(t){return new sd(e.ha,t)})},Qp.prototype.set=function(t,e,n){t=wd(t);return n?(zc("Transaction.set",n),this.Ch.set(t,e,n)):this.Ch.set(t,e),this},Qp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this.Ch.update(o,e):(t=this.Ch).update.apply(t,s([o,e,n],r)),this},Qp.prototype.delete=function(t){t=wd(t);return this.Ch.delete(t),this},Qp),Hp=(n(Xp,Gp=ll),Xp.prototype.set=function(t,e,n){t=wd(t);return n?(zc("WriteBatch.set",n),this.Ch.set(t,e,n)):this.Ch.set(t,e),this},Xp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this.Ch.update(o,e):(t=this.Ch).update.apply(t,s([o,e,n],r)),this},Xp.prototype.delete=function(t){t=wd(t);return this.Ch.delete(t),this},Xp.prototype.commit=function(){return this.Ch.commit()},Xp),Wp=(n(Yp,Fp=ll),Yp.fl=function(t,e,n){if(t.length%2!=0)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Yp(e,new sf(e.Ch,n,new hi(t)))},Yp.ca=function(t,e,n){return new Yp(e,new sf(e.Ch,n,t))},Object.defineProperty(Yp.prototype,"id",{get:function(){return this.Ch.id},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"parent",{get:function(){return new ld(this.firestore,this.Ch.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"path",{get:function(){return this.Ch.path},enumerable:!1,configurable:!0}),Yp.prototype.collection=function(t){try{return new ld(this.firestore,Pf(this.Ch,t))}catch(t){throw Kp(t,"collection()","DocumentReference.collection()")}},Yp.prototype.isEqual=function(t){return t instanceof ll&&(t=t.Ch),t instanceof sf&&xf(this.Ch,t)},Yp.prototype.set=function(t,e){e=zc("DocumentReference.set",e);try{return function(t,e,n){t=Xc(t,sf);var r=Xc(t.firestore,ql),e=bd(t.fa,e,n);return rf(r,$f(Ff(r),"setDoc",t.la,e,null!==t.fa,n).Pa(t.la,_s.ce()))}(this.Ch,t,e)}catch(t){throw Kp(t,"setDoc()","DocumentReference.set()")}},Yp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?ef(this.Ch,t):ef.apply(void 0,s([this.Ch,t,e],n))}catch(t){throw Kp(t,"updateDoc()","DocumentReference.update()")}},Yp.prototype.delete=function(){return rf(Xc((t=this.Ch).firestore,ql),[new Xs(t.la,_s.ce())]);var t},Yp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Jp(t),i=$p(t,function(t){return new sd(e.firestore,new Hl(e.firestore.Ch,e.aa,t.la,t._a,t.metadata,e.Ch.fa))});return nf(this.Ch,r,i)},Yp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Xc(e,sf);var n=Xc(e.firestore,ql),t=xp(n),r=new Zl(n);return function(n,r){var t=this,i=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.bi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof ou?s.resolve(r):r instanceof su?s.resolve(null):s.reject(new Gr(Fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Oa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,bp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.la).then(function(t){return new Hl(n,r,e.la,t,new od(t instanceof ou&&t.he,!0),e.fa)})}:"server"===(null==t?void 0:t.source)?function(e){e=Xc(e,sf);var n=Xc(e.firestore,ql);return Np(xp(n),e.la,{source:"server"}).then(function(t){return of(n,e,t)})}:function(e){e=Xc(e,sf);var n=Xc(e.firestore,ql);return Np(xp(n),e.la).then(function(t){return of(n,e,t)})})(this.Ch).then(function(t){return new sd(e.firestore,new Hl(e.firestore.Ch,e.aa,t.la,t._a,t.metadata,e.Ch.fa))})},Yp.prototype.withConverter=function(t){return new Yp(this.firestore,this.Ch.withConverter(t))},Yp);function Yp(t,e){var n=this;return(n=Fp.call(this,e)||this).firestore=t,n.aa=new kl(t),n}function Xp(){return null!==Gp&&Gp.apply(this,arguments)||this}function Qp(t,e){var n=this;return(n=zp.call(this,e)||this).ha=t,n}function Kp(t,e,n){return t.message=t.message.replace(e,n),t}function Jp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!fa(r))return r}return{}}function $p(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=fa(t[0])?t[0]:fa(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Zp,td,ed,nd,rd,id,od=(md.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},md),sd=(n(gd,id=ll),Object.defineProperty(gd.prototype,"ref",{get:function(){return new Wp(this.ha,this.Ch.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"id",{get:function(){return this.Ch.id},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"metadata",{get:function(){return this.Ch.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"exists",{get:function(){return this.Ch.exists()},enumerable:!1,configurable:!0}),gd.prototype.data=function(t){return this.Ch.data(t)},gd.prototype.get=function(t,e){return this.Ch.get(t,e)},gd.prototype.isEqual=function(t){return Jl(this.Ch,t.Ch)},gd),ud=(n(vd,rd=sd),vd.prototype.data=function(t){return this.Ch.data(t)},vd),ad=(n(yd,nd=ll),yd.prototype.where=function(t,e,n){try{return new yd(this.firestore,cf(this.Ch,(r=n,i=e,o=jl("where",t),new vf(o,i,r))))}catch(t){throw Kp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},yd.prototype.orderBy=function(n,t){try{return new yd(this.firestore,cf(this.Ch,function(t){void 0===t&&(t="asc");var e=t,t=jl("orderBy",n);return new gf(t,e)}(t)))}catch(n){throw Kp(n,/(orderBy|where)\(\)/,"Query.$1()")}},yd.prototype.limit=function(t){try{return new yd(this.firestore,cf(this.Ch,(Qc("limit",e=t),new mf("limit",e,"F"))))}catch(t){throw Kp(t,"limit()","Query.limit()")}var e},yd.prototype.limitToLast=function(t){try{return new yd(this.firestore,cf(this.Ch,(Qc("limitToLast",e=t),new mf("limitToLast",e,"L"))))}catch(t){throw Kp(t,"limitToLast()","Query.limitToLast()")}var e},yd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,cf(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Kp(t,"startAt()","Query.startAt()")}},yd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,cf(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Kp(t,"startAfter()","Query.startAfter()")}},yd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,cf(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Kp(t,"endBefore()","Query.endBefore()")}},yd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,cf(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Kp(t,"endAt()","Query.endAt()")}},yd.prototype.isEqual=function(t){return qf(this.Ch,t.Ch)},yd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Xc(e,uf);var n=Xc(e.firestore,ql),t=xp(n),r=new Zl(n);return function(n,r){var t=this,i=new sa;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ba(r,i,!0)];case 1:return n=t.sent(),e=new Vh(i,n.nr),n=e.lu(n.documents),n=e.du(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Oa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,bp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Ra).then(function(t){return new Yl(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Xc(e,uf);var n=Xc(e.firestore,ql),t=xp(n),r=new Zl(n);return Ap(t,e.Ra,{source:"server"}).then(function(t){return new Yl(n,r,e,t)})}:function(e){e=Xc(e,uf);var n=Xc(e.firestore,ql),t=xp(n),r=new Zl(n);return Rf(e.Ra),Ap(t,e.Ra).then(function(t){return new Yl(n,r,e,t)})})(this.Ch).then(function(t){return new cd(e.firestore,new Yl(e.firestore.Ch,e.aa,e.Ch,t.Ta))})},yd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Jp(t),i=$p(t,function(t){return new cd(e.firestore,new Yl(e.firestore.Ch,e.aa,e.Ch,t.Ta))});return nf(this.Ch,r,i)},yd.prototype.withConverter=function(t){return new yd(this.firestore,this.Ch.withConverter(t))},yd),hd=(n(dd,ed=ll),Object.defineProperty(dd.prototype,"type",{get:function(){return this.Ch.type},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"doc",{get:function(){return new ud(this.ha,this.Ch.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"oldIndex",{get:function(){return this.Ch.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"newIndex",{get:function(){return this.Ch.newIndex},enumerable:!1,configurable:!0}),dd),cd=(n(pd,td=ll),Object.defineProperty(pd.prototype,"query",{get:function(){return new ad(this.ha,this.Ch.query)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return this.Ch.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"size",{get:function(){return this.Ch.size},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"empty",{get:function(){return this.Ch.empty},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"docs",{get:function(){var e=this;return this.Ch.docs.map(function(t){return new ud(e.ha,t)})},enumerable:!1,configurable:!0}),pd.prototype.docChanges=function(t){var e=this;return this.Ch.docChanges(t).map(function(t){return new hd(e.ha,t)})},pd.prototype.forEach=function(e,n){var r=this;this.Ch.forEach(function(t){e.call(n,new ud(r.ha,t))})},pd.prototype.isEqual=function(t){return Jl(this.Ch,t.Ch)},pd),ld=(n(fd,Zp=ad),Object.defineProperty(fd.prototype,"id",{get:function(){return this.Ch.id},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"path",{get:function(){return this.Ch.path},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"parent",{get:function(){var t=this.Ch.parent;return t?new Wp(this.firestore,t):null},enumerable:!1,configurable:!0}),fd.prototype.doc=function(t){try{return new Wp(this.firestore,void 0===t?Vf(this.Ch):Vf(this.Ch,t))}catch(t){throw Kp(t,"doc()","CollectionReference.doc()")}},fd.prototype.add=function(t){var e,n,r,i=this;return e=this.Ch,n=t,t=Xc(e.firestore,ql),r=Vf(e),n=bd(e.fa,n),rf(t,$f(Ff(e.firestore),"addDoc",r.la,n,null!==e.fa,{}).Pa(r.la,_s.exists(!1))).then(function(){return r}).then(function(t){return new Wp(i.firestore,t)})},fd.prototype.isEqual=function(t){return xf(this.Ch,t.Ch)},fd.prototype.withConverter=function(t){return new fd(this.firestore,this.Ch.withConverter(t))},fd);function fd(t,e){var n=this;return(n=Zp.call(this,t,e)||this).firestore=t,n.Ch=e,n}function pd(t,e){var n=this;return(n=td.call(this,e)||this).ha=t,n}function dd(t,e){var n=this;return(n=ed.call(this,e)||this).ha=t,n}function yd(t,e){var n=this;return(n=nd.call(this,e)||this).firestore=t,n.aa=new kl(t),n}function vd(){return null!==rd&&rd.apply(this,arguments)||this}function gd(t,e){var n=this;return(n=id.call(this,e)||this).ha=t,n}function md(t,e){this.hasPendingWrites=t,this.fromCache=e}function wd(t){return t instanceof ll&&(t=t.Ch),Xc(t,sf)}function bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ed,Td,Id,l=(n(Cd,Td=ll),Cd.documentId=function(){return new Cd(ai.nt().Y())},Cd.prototype.isEqual=function(t){return t instanceof ll&&(t=t.Ch),t instanceof xl&&this.Ch.da.isEqual(t.da)},Cd),Ie=(n(Ad,Ed=ll),Ad.serverTimestamp=function(){var t=new ol("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Ad(t)},Ad.delete=function(){var t=new $c("deleteField");return t._methodName="FieldValue.delete",new Ad(t)},Ad.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sl("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Ad(n)},Ad.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ul("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Ad(n)},Ad.increment=function(t){t=new al("increment",t);return t._methodName="FieldValue.increment",new Ad(t)},Ad.prototype.isEqual=function(t){return this.Ch.isEqual(t.Ch)},Ad),Nd={Firestore:Pp,GeoPoint:hl,Timestamp:ii,Blob:_l,Transaction:Bp,WriteBatch:Hp,DocumentReference:Wp,DocumentSnapshot:sd,Query:ad,QueryDocumentSnapshot:ud,QuerySnapshot:cd,CollectionReference:ld,FieldPath:l,FieldValue:Ie,setLogLevel:function(t){Dr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Ad(){return null!==Ed&&Ed.apply(this,arguments)||this}function Cd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Td.call(this,new(xl.bind.apply(xl,s([void 0],t))))||this}(Id=e.default).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Pp(e,new ql(e,t),new Lp);var e},"PUBLIC").setServiceProps(Object.assign({},Nd))),Id.registerVersion("@firebase/firestore","2.0.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
